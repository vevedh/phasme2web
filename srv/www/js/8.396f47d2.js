(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([[8],{"0697":function(e,t,n){},"18a3":function(e,t,n){},"1e50":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"container q-pa-none vertical-top full-width"},[a("div",{staticClass:"column full-width items-end q-px-sm"},[a("div",{staticClass:"\n        row\n        items-center\n        q-px-sm\n        text-center text-h5\n        bg-white\n        rounded-borders\n      "},[a("span",{staticClass:"text-center"},[a("q-icon",{attrs:{name:"time",size:"10px",color:"secondary"}}),e._v("\n        Compteurs des visites pour le "+e._s(e.datedujour)+"\n      ")],1)])]),a("q-separator",{attrs:{color:"teal",size:"2px"}}),a("div",{staticClass:"row q-py-sm q-pb-md q-gutter-lg"},[a("div",{staticClass:"col-12 col-md q-pa-none"},[a("div",{staticClass:"col-md-3 col-sm-12 col-xs-12"},[a("q-item",{staticClass:"q-pa-xs q-ml-xs rounded-borders",staticStyle:{"background-color":"#4fbb91"}},[a("q-item-section",{staticClass:"q-pa-lg q-mr-none text-white",staticStyle:{"background-color":"#419e7a"},attrs:{side:""}},[a("q-icon",{attrs:{name:"support_agent",color:"white",size:"44px"}})],1),a("q-item-section",{staticClass:"q-pa-md q-ml-none text-white"},[a("q-item-label",{staticClass:"text-white text-h3 text-weight-bolder"},[e._v(e._s(e.totalRdcVisiteurs))]),a("q-item-label",{staticClass:"text-white text-h7 text-bold"},[e._v("Total Visiteurs Accueil")])],1)],1)],1)]),a("div",{staticClass:"col-12 col-md q-pa-none"},[a("div",{staticClass:"col-md-3 col-sm-12 col-xs-12"},[a("q-item",{staticClass:"q-pa-xs q-ml-xs bg-blue-7 rounded-borders"},[a("q-item-section",{staticClass:"q-pa-lg q-mr-none text-white bg-blue-8",attrs:{side:""}},[a("q-icon",{attrs:{name:"directions_car_filled",color:"white",size:"44px"}})],1),a("q-item-section",{staticClass:"q-pa-md q-ml-none text-white"},[a("q-item-label",{staticClass:"text-white text-h3 text-weight-bolder"},[e._v(e._s(e.totalParkingVisiteurs))]),a("q-item-label",{staticClass:"text-white text-h7 text-bold"},[e._v("Total Visiteurs Parking")])],1)],1)],1)]),a("div",{staticClass:"col-12 col-md q-pa-none"},[a("div",{staticClass:"col-md-3 col-sm-12 col-xs-12"},[a("q-item",{staticClass:"q-pa-xs q-ml-xs bg-teal-7 rounded-borders"},[a("q-item-section",{staticClass:"q-pa-lg q-mr-none text-white bg-teal-8",attrs:{side:""}},[a("q-icon",{attrs:{name:"people",color:"white",size:"44px"}})],1),a("q-item-section",{staticClass:"q-pa-md q-ml-none text-white"},[a("q-item-label",{staticClass:"text-white text-h3 text-weight-bolder"},[e._v(e._s(e.totalVisiteurs))]),a("q-item-label",{staticClass:"text-white text-h7 text-bold"},[e._v("Visiteurs à la CACEM le "+e._s(e.datedujour))])],1)],1)],1)])]),a("q-separator",{attrs:{color:"teal",size:"2px"}}),a("div",{staticClass:"col-12 col-md q-px-none q-pt-md"},[a("f-acceuil-grid",{ref:"myTable",style:(e.$q.platform.is.mobile,{width:"100%"}),attrs:{titre:"Registre Visiteur ",dbname:"dbf_accueil",dbtype:"db_regvisiteurs",selectable:e.allowRegistre||e.isAdmin,editable:e.allowRegistre||e.isAdmin,useAdmin:e.isAdmin,columns_filter:!0,showAdd:!0,allowexport:!0},on:{"row-click":e.onRowClick}})],1),a("q-dialog",{model:{value:e.showMailMessage,callback:function(t){e.showMailMessage=t},expression:"showMailMessage"}},[a("q-card",{staticClass:"email-card",attrs:{bordered:""}},[a("q-toolbar",{staticClass:"full-width bg-primary"},[a("div",{staticClass:"q-pt-xs"},[a("img",{attrs:{src:n("056e")}})]),a("q-toolbar-title",{staticClass:"text-center text-white"},[a("q-icon",{staticClass:"q-px-md text-white",attrs:{name:"mail"}}),e._v("\n          Envoi d'un mail\n        ")],1),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close",color:"white"}})],1),a("q-card-section",[a("div",{staticClass:"row q-pa-xs"},[a("div",{staticClass:"col-12 q-pa-xs"},[a("q-input",{attrs:{label:"Envoyé vers :"},model:{value:e.senderTo,callback:function(t){e.senderTo=t},expression:"senderTo"}})],1),a("div",{staticClass:"col-12 q-pa-xs"},[a("q-input",{attrs:{label:"Objet :"},model:{value:e.subjectTo,callback:function(t){e.subjectTo=t},expression:"subjectTo"}})],1),a("div",{staticClass:"col-12"},[a("q-editor",{ref:"mailContent",attrs:{"min-height":"15rem"},model:{value:e.messageTo,callback:function(t){e.messageTo=t},expression:"messageTo"}})],1),a("div",{staticClass:"col-12 q-gutter-md q-py-md"},[a("q-btn",{attrs:{icon:"save",color:"primary","text-color":"white","no-caps":"",label:"Memoriser le message et le destinataire"},on:{click:function(t){return e.saveSendMail()}}}),a("q-btn",{attrs:{icon:"mail",color:"blue-3","text-color":"black",label:"Envoyé"},on:{click:function(t){return e.testSendMail()}}})],1)])])],1)],1),a("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showAdminMenu,callback:function(t){e.showAdminMenu=t},expression:"showAdminMenu"}},[a("q-card",{staticStyle:{width:"280px"}},[a("q-linear-progress",{attrs:{value:1,color:"amber"}}),a("q-card-section",{staticClass:"row items-start no-wrap"},[a("q-list",[a("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n            Menu Administrateur\n          ")]),a("q-item",{attrs:{clickable:"",to:"/"}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"home"}})],1),a("q-item-section",[a("q-item-label",[e._v("Accueil")]),a("q-item-label",{attrs:{caption:""}},[e._v(" Retour à l'accueil ")])],1)],1)],1)],1)],1)],1),a("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showUserMenu,callback:function(t){e.showUserMenu=t},expression:"showUserMenu"}},[a("q-card",{staticStyle:{width:"280px"}},[a("q-linear-progress",{attrs:{value:1,color:"amber"}}),a("q-card-section",{staticClass:"row items-start no-wrap"},[a("q-list",[a("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n            Menu Utilisateur\n          ")]),a("q-item",{attrs:{clickable:"",to:"/"}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"home"}})],1),a("q-item-section",[a("q-item-label",[e._v("Accueil")]),a("q-item-label",{attrs:{caption:""}},[e._v(" Retour à l'accueil ")])],1)],1),a("q-item",{attrs:{clickable:""},on:{click:function(t){return e.openExtURL("http://svrsharepoint2/sites/DAG/DAAP/Documents%20partages/Forms/AllItems.aspx")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"doc"}})],1),a("q-item-section",[a("q-item-label",[e._v("Documentation")]),a("q-item-label",{attrs:{caption:""}},[e._v("\n                Archives et Acceuil du public\n              ")])],1)],1)],1)],1)],1)],1)],1)},s=[],i=n("c973"),r=n.n(i),o=n("ded3"),l=n.n(o),c=(n("96cf"),n("ac1f"),n("1276"),n("caad"),n("2532"),n("4de4"),n("d3b7"),n("cca6"),n("ed09")),u=n("2f62"),d=n("bc78"),m=n("cf57"),f=n("163c"),p=n("bd4c"),b=n("b06b"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[e.show_ExcelImport?n("div",{staticClass:"row fit q-pb-md items-right justify-right full-width"},[n("q-uploader",{ref:"uploader",staticClass:"full-width q-px-none",attrs:{multiple:!1,"hide-upload-btn":!0,square:"",outlined:"",label:"Sélectionner un fichier excel",type:"file"},on:{added:e.onChange}}),e.currentFile.name?n("q-btn",{attrs:{color:"primary","text-color":"white",label:"Utiliser comme base de donnée"},on:{click:function(t){return e.saveToDatabase()}}}):e._e()],1):e._e(),n("q-table",{ref:"myTable",attrs:{id:"myTable",title:e.setTitle,data:e.datas?e.datas:e.liveDatas,"row-key":function(e){return e._id?e._id:e[Object.keys(e)[0]]},selection:e.useSelection,columns:e.newColumns,filter:e.filter,"no-data-label":"pas de données pour l'instant...","no-results-label":"Aucun résultat trouvé",selected:e.useSelected,"visible-columns":e.visibleColumns,pagination:e.initialPagination,separator:"cell"},on:{"row-click":e.rowSelect,"update:selected":function(t){e.useSelected=t}},scopedSlots:e._u([{key:"header",fn:function(t){return[n("q-tr",{attrs:{props:t}},[e.editable?n("q-th",{staticClass:"text-bold text-primary bg-blue-1",attrs:{"auto-width":""}}):e._e(),e._l(t.cols,(function(a){return n("q-th",{key:a.name,staticClass:"text-bold text-primary bg-blue-1",attrs:{props:t}},[e.headers_filter?n("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Filtre",icon:"filter_alt"}},[n("q-popup-edit",{ref:"filter_"+a.name,refInFor:!0,attrs:{cover:!1,offset:[0,2]},scopedSlots:e._u([{key:"default",fn:function(t){return[e.datesFields.includes(a.name)?n("div",{staticClass:"q-pa-none",staticStyle:{width:"180px"}},[n("div",{staticClass:"text-body2 text-grey q-mb-md"},[e._v("\n                                    Critère de filtre ["+e._s(a.name)+"]\n                                ")]),n("div",{staticClass:"row items-center"},[n("div",{staticClass:"q-pa-none text-caption text-dark full-width"},[n("q-select",{attrs:{dense:"",filled:"",options:["annee","mois","jour"],label:"Date par"},model:{value:e.filtersParams[a.name].option,callback:function(t){e.$set(e.filtersParams[a.name],"option",t)},expression:"filtersParams[col.name].option"}})],1),n("div",{staticClass:"col-12 q-pa-none"},[n("q-input",{attrs:{dense:""},model:{value:e.filtersParams[a.name].value,callback:function(t){e.$set(e.filtersParams[a.name],"value",t)},expression:"filtersParams[col.name].value"}})],1),n("div",{staticClass:"q-pa-sm q-gutter-md"},[n("q-btn",{staticStyle:{"min-width":"68px"},attrs:{dense:"","no-caps":"",color:"primary",size:"sm",label:"Filtrer"},on:{click:function(n){return e.updateFilters(t,a.name)}}}),n("q-btn",{staticStyle:{"min-width":"68px"},attrs:{dense:"","no-caps":"",color:"grey-7",size:"sm",label:"Effacer"},on:{click:function(n){return e.deleteFilters(t,a.name)}}})],1)])]):e._e()]}}],null,!0),model:{value:e.filtersParams[a.name],callback:function(t){e.$set(e.filtersParams,a.name,t)},expression:"filtersParams[col.name]"}})],1):e._e(),e._v("\n                    "+e._s(String(a.label).toUpperCase())+"\n                ")],1)}))],2),e.columns_filter?n("q-tr",{staticClass:"ignore-elements",attrs:{props:t}},[e.editable?n("q-th",{staticClass:"text-bold text-primary bg-blue-1",attrs:{"auto-width":""}},[n("q-icon",{attrs:{name:"filter_alt",size:"20px"}})],1):e._e(),e._l(t.cols,(function(t){return n("q-th",{key:t.name,staticStyle:{padding:"0px 0px 0px 0px"}},[t.hasOwnProperty("filter_type")&&"text"!=t.filter_type?e._e():n("q-input",{staticClass:"q-pl-xs q-pr-xs",attrs:{dense:"",color:"teal",filled:""},on:{input:e.filterColumn},scopedSlots:e._u([e.filter_data[t.field]?{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"cancel"},on:{click:function(n){n.stopPropagation(),e.filter_data[t.field]="",e.filterColumn(t.field)}}})]},proxy:!0}:null],null,!0),model:{value:e.filter_data[t.field],callback:function(n){e.$set(e.filter_data,t.field,n)},expression:"filter_data[col.field]"}}),t.hasOwnProperty("filter_type")&&"select"==t.filter_type?n("q-select",{attrs:{"map-options":"",multiple:"","emit-value":"",filled:"",options:e.getColumnOptions(t.field),dense:""},scopedSlots:e._u([{key:"append",fn:function(){return[e.column_options_selected[t.field].length>0?n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(n){n.stopPropagation(),e.column_options_selected[t.field]=[]}}}):e._e()]},proxy:!0}],null,!0),model:{value:e.column_options_selected[t.field],callback:function(n){e.$set(e.column_options_selected,t.field,n)},expression:"column_options_selected[col.field]"}}):e._e()],1)}))],2):e._e()]}},{key:"body",fn:function(t){return[n("q-tr",{class:t.rowIndex%2===0?"bg-teal-1  q-pa-none":"bg-white  q-pa-none",attrs:{props:t}},[e.editable?n("q-td",{staticClass:"q-pa-none"},[n("div",{staticClass:"q-pa-none fit flex flex-center text-center non-selectable"},[n("div",{staticClass:"q-gutter-sm",attrs:{"auto-width":!0}},[n("q-checkbox",{attrs:{color:"teal"},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"props.selected"}})],1)])]):e._e(),e._l(t.cols,(function(a){return n("q-td",{key:a.name,staticClass:"q-pa-none",attrs:{props:t}},[e.ifJSON(a.value)?n("json-viewer",{attrs:{value:a.value}}):n("div",{staticClass:"q-pa-none inline cursor-pointer"},[n("div",{staticClass:"\n              q-pa-none\n              fit\n              flex flex-center\n              text-center\n              non-selectable\n            "},[e._v("\n                             "+e._s(a.value)+"\n                        ")])])],1)}))],2)]}},{key:"top",fn:function(t){return[n("div",{staticClass:"col-12 col-md full-width "},[n("div",{staticClass:"row q-gutter-sm text-h6 q-px-sm "},[n("span",{staticClass:"row items-center text-h8  q-pa-none"},[e._v(e._s(""!=e.currentAcces?e.setTitle+" ["+e.currentAcces+"]":""+e.setTitle))]),n("q-space"),n("span",{staticClass:"row items-center text-h8  q-pa-none"},[e._v("Visiteurs accueil RDC\n                         "),n("q-avatar",{attrs:{color:"blue",size:"35px","font-size":"20px","text-color":"white"}},[e._v(e._s(e.nbRdc))])],1),n("span",[e._v(" ")]),e.nbResParking&&""!=String(e.nbResParking).trim()?n("span",{staticClass:"row items-center"},[e._v(e._s(e.nbResParking)+" réservations PARKING")]):e._e()],1),n("q-separator",{staticClass:"q-my-sm bg-teal"}),n("div",{staticClass:"row q-gutter-sm q-py-md"},[e.useAdmin&&!e.hideexcel?n("q-btn",{staticClass:"q-px-sm",attrs:{color:"primary",dense:"","no-caps":""},on:{click:function(t){e.show_ExcelImport=!0}}},[n("q-icon",{attrs:{size:"0.9em",name:"far fa-file-excel"}}),n("q-icon",{attrs:{size:"0.9em",name:"fas fa-arrow-right"}}),n("q-icon",{attrs:{size:"0.9em",name:"fas fa-database"}}),n("div",{staticClass:"q-px-sm"},[e._v("Excel Init")])],1):e._e()],1),n("div",{staticClass:"row q-gutter-sm q-px-sm q-pb-md justify-center"},[n("q-btn-dropdown",{attrs:{color:"primary"},scopedSlots:e._u([{key:"label",fn:function(){return[n("div",{staticClass:"row items-center no-wrap"},[n("q-icon",{attrs:{left:"",name:"filter_alt",color:""==e.currentAcces||null==e.currentAcces?"white":"red"}}),n("div",{staticClass:"text-center"},[e._v("Lieu")])],1)]},proxy:!0}],null,!0)},e._l(e.lieuAcces,(function(t){return n("q-list",{key:"lieu-"+t},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(n){return e.filterTypeAcces(t)}}},[n("q-item-section",[n("q-item-label",[e._v(e._s(t))])],1)],1)],1)})),1),n("q-btn",{staticClass:"q-px-md text-subtitle2 text-bold text-primary bg-amber-3",attrs:{dense:"","no-caps":"",filled:""}},[n("div",{staticClass:"row items-center no-wrap"},[n("q-icon",{attrs:{left:"",name:"filter_alt",color:e.currentDateSel&&""!=e.currentDateSel.from&&""!=e.currentDateSel.to?"red":"primary"}}),n("div",{staticClass:"text-center"},[e._v("\n                                Les visites entre le\n                                "),n("span",{staticClass:"text-bold text-accent"},[e._v(e._s(Object(e.dateRange).hasOwnProperty("from")?e.dateRange.from:null))]),e._v("\n                                et le (cliquez-ici)\n                                "),n("span",{staticClass:"text-bold text-red"},[e._v(e._s(Object(e.dateRange).hasOwnProperty("to")?e.dateRange.to:null))])])],1),n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{locale:e.myLocale,mask:"DD/MM/YYYY",range:"",minimal:""},on:{"range-end":function(t){return e.filterRangeDate(e.dateRange)}},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}},[n("div",{staticClass:"row items-center justify-end"},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Fermer",color:"primary",flat:""}})],1)])],1),n("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n                            Cliquez-ici pour voir les visites entre 2 dates\n                        ")])],1),n("q-btn",{staticClass:"q-px-md text-subtitle2 text-bold text-primary bg-amber-3",attrs:{dense:"","no-caps":"",filled:"","shadow-4":""}},[n("div",{staticClass:"row items-center no-wrap"},[n("q-icon",{attrs:{left:"",name:"filter_alt",color:e.dateSelected&&""!=e.dateSelected?"red":"primary"}}),n("div",{staticClass:"text-center"},[e._v("\n                                Visites pour\n                                "),n("span",{class:e.dateSelected&&""!=e.dateSelected?"text-bold text-h6 text-red":null},[e._v(e._s(e.dateSelected&&""!=e.dateSelected?e.dateSelected:"la date"))]),e._v("\n                                (cliquez-ici)\n                            ")])],1),n("q-popup-proxy",{ref:"btnDatej",attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{locale:e.myLocale,mask:"DD/MM/YYYY",minimal:""},on:{input:function(t){e.filterDateVisite(e.dateSelected),e.$refs.btnDatej.hide()}},model:{value:e.dateSelected,callback:function(t){e.dateSelected=t},expression:"dateSelected"}})],1),n("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n                            Cliquez-ici pour voir les visites pour une date précise\n                        ")])],1),n("q-btn",{attrs:{icon:"filter_alt_off",color:"primary","no-caps":"",label:"Effacer les filtres"},on:{click:function(t){e.currentAcces="",e.customFilter="",e.dateSelected=null,e.currentDateSel=null,e.dateRange=null}}},[n("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n                            Cliquez-ici pour effacer les filtres\n                        ")])],1),n("q-btn",{staticClass:"text-subtitle2 text-bold text-primary bg-amber-3",attrs:{label:"Chronologie aujourd'hui",icon:"timeline","no-caps":""},on:{click:e.showTimeLine}})],1),n("div",{staticClass:"row q-gutter-sm q-pb-md"}),e.allowexport?n("div",{staticClass:"row q-gutter-sm q-pb-md"},[n("q-btn",{staticClass:"bg-primary",attrs:{dense:"",flat:"","no-caps":"","text-color":"white",icon:"far fa-file-excel",label:".xlsx"},on:{click:function(t){return e.exportDatasExcel()}}}),n("q-btn",{staticClass:"bg-primary",attrs:{dense:"","no-caps":"",flat:"","text-color":"white",icon:"fas fa-file-csv",label:".csv"},on:{click:function(t){return e.exportCsvTable()}}}),n("q-btn",{staticClass:"bg-primary",attrs:{dense:"","no-caps":"",flat:"",filled:"","text-color":"white",icon:"far fa-file-pdf",label:".pdf"},on:{click:function(t){return e.exportDatasPdf()}}})],1):e._e(),n("div",{staticClass:"row q-gutter-sm q-px-none q-pb-md full-width"},[n("q-input",{staticStyle:{width:"60%"},attrs:{dense:"",filled:"",debounce:"300",placeholder:"Recherche","label-color":"text-dark"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[n("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),n("q-space"),n("q-select",{staticStyle:{"min-width":"150px"},attrs:{multiple:"",outlined:"",dense:"","options-dense":"","display-value":e.$q.lang.table.columns,"emit-value":"","map-options":"",options:e.newColumns,"option-value":"name","options-cover":""},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}}),0!=e.newColumns.length&&e.showAdd?n("q-btn",{staticClass:"q-px-sm",attrs:{color:"primary",icon:"add","no-caps":""},on:{click:function(t){e.show_AddDialog=!0}}},[e._v("Nouveau Visiteur")]):e._e(),n("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}})],1)],1)]}},e.selected&&e.selected.length>0?{key:"bottom-row",fn:function(){return[n("q-tr",[n("q-td",{staticClass:"q-pa-md",attrs:{colspan:"100%"}},[e.selected&&e.selected.length>0&&e.editable?n("q-btn",{staticClass:"q-px-md q-mx-sm",attrs:{color:"red",dense:"","no-caps":""},on:{click:e.supPrevBtn}},[e._v("Supprimer")]):e._e(),e.selected&&e.selected.length>0&&e.editable?n("q-btn",{staticClass:"q-px-md q-mx-sm",attrs:{color:"grey-8",dense:"","no-caps":""},on:{click:function(t){e.show_EditDialog=!0}}},[e._v("Modifier")]):e._e()],1)],1)]},proxy:!0}:null],null,!0)}),n("q-dialog",{model:{value:e.show_EditDialog,callback:function(t){e.show_EditDialog=t},expression:"show_EditDialog"}},[n("q-card",{staticStyle:{width:"80%","max-width":"100%"}},[n("q-toolbar",{staticClass:"text-white full-width bg-blue"},[n("q-toolbar-title",{staticClass:"text-h5"},[e._v("\n                                    Modification !\n                                ")]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),n("q-card-section",{staticClass:"q-pa-md",staticStyle:{width:"100%","max-width":"100%"}},[n("f-vv-form-by-name",{ref:"editForm",staticClass:"q-pa-sm",attrs:{nameForm:"PARKING"==e.selectedRow.typeacces?"Demande Parking":"Accueil",fieldsmodel:e.selectedRow,hiddenFields:[{chargeaccueil:e.currentUsername}]}})],1),n("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"center"}},[n("div",{staticClass:" row full-width q-gutter-xl items-center justify-center"},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Annuler",color:"primary"},on:{click:function(t){e.show_EditDialog=!1}}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Modifier",color:"primary"},on:{click:e.updateRow}})],1)])],1)],1),n("q-dialog",{model:{value:e.show_AddDialog,callback:function(t){e.show_AddDialog=t},expression:"show_AddDialog"}},[n("q-card",{staticStyle:{width:"80%","max-width":"100%"}},[n("q-toolbar",{staticClass:"text-white full-width bg-blue"},[n("q-toolbar-title",{staticClass:"text-h5"},[e._v("\n                                    Ajout d'un visiteur !\n                                ")]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),n("q-card-section",{staticClass:"q-pa-md",staticStyle:{width:"100%","max-width":"100%"}},[n("f-vv-form-by-name",{ref:"addForm",staticClass:"q-pa-sm",attrs:{nameForm:"Accueil",fieldsmodel:{chargeaccueil:e.currentUsername},hiddenFields:[{chargeaccueil:e.currentUsername}],showSave:!0,saveLabel:"Enregistrer"},on:{onFormAdded:e.addRow}})],1)],1)],1)],1)},g=[],v=n("278c"),w=n.n(v),q=n("448a"),x=n.n(q),y=(n("4160"),n("159b"),n("b64b"),n("4e82"),n("a434"),n("c975"),n("a623"),n("e9c4"),n("d81d"),n("498a"),n("13d5"),n("e260"),n("e6cf"),n("3ca3"),n("ddb0"),n("4fadc"),n("6062"),n("d401"),n("25f0"),n("5319"),n("7db0"),n("c740"),n("a9e3"),n("1146")),C=n("8baf"),_=(n("0da4"),n("5494")),D=n("9c40"),k=n("05c0"),A=n("a357"),S=n("70e7"),O=n("7596"),R=n("9ef0"),j=Object(c["d"])({components:{FVvForm:O["a"],DiagTimeLineJour:S["a"],FVvFormByName:R["a"]},name:"FAcceuilGrid",data:function(){var e={days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_"),firstDayOfWeek:0};return{myLocale:e,currentDateSel:null,dateSelected:"",currentAcces:"",lieuAcces:[],data:[],currentFile:{},show_ExcelImport:!1,initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:5},visibleColumns:[],show_AddDialog:!1,show_EditDialog:!1,newColumns:[],editRow:{},selected:[],selectedRow:{},dateRange:{},filter:"",filters:{},filtersParams:{},filtersOperator:{},filter_data:{},column_options:{},column_options_selected:{},datesFields:[],customFilter:null,datedujour:p["b"].formatDate(Date.now(),"DD/MM/YYYY")}},props:{dbname:{type:String,required:!1},dbtype:{type:String,default:"mongodb",required:!1},datas:{type:Array,required:!1},columns:{type:Array,required:!1},headers_filter:{type:Boolean,default:!1,required:!1},columns_filter:{type:Boolean,default:!1,required:!1},labelsColumns:{type:Array,default:null,required:!1},editable:{type:Boolean,default:!0,required:!1},hideid:{type:Boolean,default:!0,required:!1},excelimport:{type:Boolean,default:!1,required:!1},allowexport:{type:Boolean,default:!1,required:!1},hideexcel:{type:Boolean,default:!0,required:!1},titre:{type:String,default:"",required:!1},useAdmin:{type:Boolean,default:!1,required:!1},selectable:{type:Boolean,default:!1,required:!1},showAdd:{type:Boolean,default:!1,required:!1}},computed:{currentUsername:function(){return console.log("Root :",this.$store),this.$store.state.auth.user.sAMAccountName},setTitle:function(){return""==this.titre?this.dbname:this.titre},liveDatas:function(){return this.dbtype||this.dbname?Array.isArray(this.customFilter)?this.customFilter:this.data:x()(this.datas)},useSelection:function(){return this.editable||this.selectable?"single":"none"},nbRdc:function(){return this.liveDatas.filter((function(e){return"RDC"==e.typeacces&&"parking"!=e.etat})).length},nbParking:function(){return this.liveDatas.filter((function(e){return"PARKING"==e.typeacces&&"parking"==e.etat})).length},nbResParking:function(){},useSelected:{get:function(){return this.editable||this.selectable?this.selected:[]},set:function(e){this.selected=e}},visiteursDuJour:function(){var e=this;if(this.$store.state.admin.visiteurs&&Array.isArray(this.$store.state.admin.visiteurs))return this.$store.state.admin.visiteurs.filter((function(t){return t.datevisite==e.datedujour&&"attente"!=t.etat&&"efface"!=t.etat&&"RDC"==t.typeacces})).sort((function(e,t){var n=e.heurevisite,a=t.heurevisite;return n<a?1:-1}))}},methods:l()(l()(l()({},Object(u["b"])("admin",["getAllVisiteurs","addVisiteur","getForm","saveForm","getConfig","writeConfig"])),{},{objectsNotIn:function(e,t){var n=[];return Object.keys(e).forEach((function(e){Object.keys(t).includes(e)||n.push(e)})),n.splice(n.indexOf("_id"),1),n},filterArray:function(e,t){var n=Object.keys(t);return e.filter((function(e){return n.every((function(n){return"function"!==typeof t[n]||t[n](e[n])}))}))},ifJSON:function(e){try{return!("[object Object]"!==Object.prototype.toString.call(e)&&!Array.isArray(e))}catch(error){return!1}},onChange:function(e){var t=this,n=e?e[0]:null;console.log("File :",n),this.currentFile=n;var a=n;console.log("Files data :",a);var s=new FileReader;s.onload=function(e){var n=e.target.result,a=y["read"](n,{type:"binary",cellDates:!0}),s=a.SheetNames[0],i=a.Sheets[s];t.data&&(t.data=y["utils"].sheet_to_json(i,{header:0,raw:!0})),console.log("Datas :",t.data);var r=y["utils"].sheet_to_json(i,{header:1,raw:!0});if(console.log("Datas headers :",r),console.log("Datas with header :",r.length),Array.isArray(r)&&r.length>0){t.newColumns=[],console.log("Keys headers :",JSON.parse(JSON.stringify(r[0])));var o=JSON.parse(JSON.stringify(r[0])),l=o.map((function(e){return"".concat(String(e).trim())}));console.log("Keys headers :",l),t.visibleColumns=l,o.forEach((function(e){"string"==typeof e&&t.newColumns.push({name:e,field:e,label:e,sortable:!0})}))}},s.readAsBinaryString(n)},saveToDatabase:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object.assign([],e.data),a=[],e.data=Object.assign([],a),Array.isArray(n)){t.next=5;break}return t.abrupt("return");case 5:n.forEach(function(){var t=r()(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_["c"].service("tables").create(JSON.parse(JSON.stringify(n)),{query:{tableDb:e.dbtype,tableName:e.dbname}});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n.length>0&&(s=Object.keys(n[0]),console.log("Columns :",s),e.editRow=s.reduce((function(e,t){return e[t]="",e}),{}),e.newColumns=s.map((function(e){return{name:e,align:"center",label:e,field:e,sortable:!0}}))),e.visibleColumns=Object.assign([],e.newColumns),e.hideid&&(e.visibleColumns=Object.assign([],e.visibleColumns.filter((function(e){return"_id"!=e.field})).map((function(e){return"".concat(e.field.trim())}))),console.log("Visible columns :",e.visibleColumns)),setTimeout(r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.updateDatas();case 2:e.show_ExcelImport=!1;case 3:case"end":return t.stop()}}),t)}))),1e3);case 10:case"end":return t.stop()}}),t)})))()},exportDatasExcel:function(){var e=this;Promise.resolve().then(n.t.bind(null,"1146",7)).then((function(t){var n,a,s;if(s=e.data,e.newColumns.length>0){var i=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),i.push(s)})),n=e.newColumns,a=i}else{var r=[];e.newColumns.forEach((function(e){var t={title:e.name,dataKey:e.field};"Actions"!=e.name&&r.push(t)})),console.log("Columns :",r),n=r;var o=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),o.push(s)})),a=o}a.map((function(e){return delete e._id,e}));var l=[n.filter((function(e){return"_id"!=e.name})).map((function(e){return e.name}))],c=y["utils"].book_new();t.utils.sheet_add_aoa(c,l);var u=t.utils.sheet_add_json(c,a,{origin:"A2",skipHeader:!0}),d={Sheets:{data:u},SheetNames:["data"]},m=t.write(d,{bookType:"xlsx",type:"array"}),f=Object(A["a"])("table-export.xlsx",m,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8");!0!==f&&e.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}))},exportDatasPdf:function(){var e=this;Promise.resolve().then(n.t.bind(null,"0da4",7)).then((function(t){var n,a,s=new C["jsPDF"];if(e.newColumns.length>0){var i=[];e.data.forEach((function(t,n,a){var s=[];e.newColumns.forEach((function(e,n,a){"_id"!=e.field&&s.push(t[e.field])})),console.log("données exportables:",s),i.push(s)}));var r=Object.assign([],e.newColumns);delete r._id,n=[r.filter((function(e){return"_id"!=e.name})).map((function(e){return e.name}))],a=i}console.log("Columns :",n),console.log("Body :",a),s.autoTable({head:n,body:a}),s.save("export-table.pdf")}))},exportCsvTable:function(){var e=this;Promise.resolve().then(n.t.bind(null,"1146",7)).then((function(t){var n,a,s;if(s=e.data,e.newColumns.length>0){var i=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),i.push(s)})),n=e.newColumns,a=i}else{var r=[];e.newColumns.forEach((function(e){var t={title:e.name,dataKey:e.field};"Actions"!=e.name&&r.push(t)})),console.log("Columns :",r),n=r;var o=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),o.push(s)})),a=o}a.map((function(e){return delete e._id,e}));var l=[n.filter((function(e){return"_id"!=e.name})).map((function(e){return e.name}))],c=y["utils"].book_new();t.utils.sheet_add_aoa(c,l);var u=t.utils.sheet_add_json(c,a,{origin:"A2",skipHeader:!0}),d=t.utils.sheet_to_csv(u,{FS:","}),m=Object(A["a"])("table-export.csv",d,"text/csv");!0!==m&&e.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}))},rowSelect:function(e,t,n){this.$emit("row-click",e,t,n)}},Object(u["b"])("tables",{getDatas:"getTableQuery"})),{},{whereDateYearEq:function(e){return function(t){return t.split("/")[2]===e}},whereDateMonthrEq:function(e){return function(t){return t.split("/")[2]===e}},whereDateDayEq:function(e){return function(t){return t.split("/")[2]===e}},whereContain:function(e){return function(t){return-1!=String(t).toLowerCase().indexOf(e.toLowerCase())}},whereDateBetween:function(e,t){return function(n){return p["b"].isBetweenDates(new Date(n.split("/")[2],n.split("/")[1],n.split("/")[0]),new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]),new Date(t.split("/")[2],t.split("/")[1],t.split("/")[0]),{onlyDate:!0,inclusiveFrom:!0,inclusiveTo:!0})}},whereDateDuJour:function(e){var t=new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]);return function(e){return p["b"].isSameDate(new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]),t)}},whereTypeAcces:function(e){return function(t){return String(t).trim()==e}},filterRangeDate:function(e){console.log("test datesel",e),e&&Object(e).hasOwnProperty("from")&&Object(e).hasOwnProperty("to")&&(console.log("test datesel 1 :",e),this.currentDateSel=Object.assign({},e),e.from&&e.to&&(this.filters["datevisite"]=this.whereDateBetween(e.from,e.to),console.log("filtre :",this.filters["datevisite"]),this.customFilter=this.filterArray(this.data,this.filters)))},filterDateVisite:function(e){e&&(this.filters["datevisite"]=this.whereDateDuJour(e),this.customFilter=this.filterArray(this.data,this.filters))},filterTypeAcces:function(e){e&&(this.currentAcces=e,this.filters["typeacces"]=this.whereTypeAcces(e),this.customFilter=this.filterArray(this.data,this.filters))},filterColumn:function(e){var t=this;console.log("Filter data :",this.filter_data),console.log("Value :",e),console.log("Donnees :",this.data.filter((function(n){return-1!=String(n[Object.keys(t.filter_data)[0]]).indexOf(e)})));var n=Object.entries(this.filter_data).map((function(e){var t=w()(e,2),n=t[0],a=t[1];return{key:n,value:a}}));console.log("Donnees :",n),n.forEach((function(e){t.filters[e.key]=t.whereContain(e.value)})),this.customFilter=this.filterArray(this.data,this.filters)},updateFilters:function(e,t){console.log("Object SCOPE :",e),Object(e.value).hasOwnProperty("option")&&(e.value.option&&"annee"===e.value.option&&(this.filters["".concat(t)]=""!=e.value.value?this.whereDateYearEq(e.value.value):""),e.value.option&&"mois"===e.value.option&&(this.filters["".concat(t)]=""!=e.value.value?this.whereDateMonthEq(e.value.value):""),e.value.option&&"jour"===e.value.option&&(this.filters["".concat(t)]=""!=e.value.value?this.whereDateDayEq(e.value.value):"")),console.log("Filters :",this.filters),console.log("Filters Params:",this.filtersParams),console.log("Colonne filtre update :",t),this.customFilter=this.filterArray(this.data,this.filters),e.set()},getColumnOptions:function(e){var t=x()(new Set(this.data.map((function(t){return t[e]})))),n=[];return t.filter((function(e){return n.push({label:e.toString(),value:e.toString().toLowerCase().replace(/_/g,"_")}),e})),n},deleteFilters:function(e,t){this.filters["".concat(t)]="",this.customFilter=this.filterArray(this.data,this.filters),this.filtersParams["".concat(t)].value="",e.set()},addRow:function(e){var t=this;return r()(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(0!=t.newColumns.length){n.next=2;break}return n.abrupt("return");case 2:return t.editRow=e,console.log("Add rows :",t.editRow),n.next=6,t.$store.dispatch("tables/create",[t.editRow,{query:{tableDb:t.dbtype,tableName:t.dbname}}]);case 6:a=n.sent,console.log("Added row :",a),t.refreshDatas(),t.show_AddDialog=!1;case 10:case"end":return n.stop()}}),n)})))()},updateRow:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("Edit rows :",e.selectedRow),delete e.$refs["editForm"].fieldData._id,console.log("Form datas :",e.$refs["editForm"].fieldData),!e.selectedRow){t.next=9;break}return t.next=6,_["c"].service("tables").update(e.selectedRow._id,e.$refs["editForm"].fieldData,{query:{tableDb:e.dbtype,tableName:e.dbname}});case 6:n=t.sent,console.log("Données modifiées :",n),e.refreshDatas();case 9:case"end":return t.stop()}}),t)})))()},addFormDatas:function(e){var t=this;return r()(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.$q.loading.show({spinner:m["a"],spinnerColor:"red",message:"Chargement en cours..."}),n.next=3,t.addVisiteur(e);case 3:t.$q.loading.hide(),console.log("Valeur des champs :",e);case 5:case"end":return n.stop()}}),n)})))()},refreshDatas:function(){var e=this,t=this.$FeathersVuex.api.Table;this.dbtype&&this.dbname?t.find({query:{tableDb:this.dbtype,tableName:this.dbname,query:JSON.stringify({})}}).then(function(){var t=r()(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("Table :",n),console.log("DbName :",e.dbname),e.data=Object.assign([],n.map((function(e){return Object(e).hasOwnProperty("etat")?l()({},e):l()(l()({},e),{},{etat:""})})).filter((function(e){return"attente"!=e.etat&&"efface"!=e.etat&&"sortie"!=e.etat}))).map((function(e){return Object.assign({},l()({},e),{contactinterne:String(e.contactinterne).split("[")[0].trim()})})).sort((function(e,t){var n=p["b"].formatDate(e.datevisite,"YYYYMMDD"),a=p["b"].formatDate(t.datevisite,"YYYYMMDD");return n<a?1:-1})),t.next=5,e.updateDatas();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.data=Object.assign([],this.datas),this.filterTypeAcces("RDC")},updateDatas:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n,a,s,i,r,o,l,c,u,d,m,f,p,b,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=Object.assign([],e.data),console.log("Table result info data :",e.data),console.log("Table result info avant parking :",e.data.filter((function(e){return"PARKING"==e.typeacces}))),i=s.map((function(e){return"".concat(Object.keys(e).length)})),console.log("Count keys :",i),r=Math.max.apply(Math,x()(i)),o=Math.min.apply(Math,x()(i)),console.log("Nb max props :",r),console.log("Nb min props :",o),l=i.findIndex((function(e){return Number(e)==Number(r)})),console.log("Nb maxCols props :",l),c=Object.assign([],s),console.log("Data max :",c[l]),u=i.findIndex((function(e){return Number(e)==Number(o)})),console.log("Data min :",c[u]),d=Object.assign({},c[l],c[u]),console.log("Fusion Obj :",d),m=Object.keys(d),console.log("Columns :",m),console.log("Table result info entre parking :",s.filter((function(e){return"PARKING"==e.typeacces}))),t.next=22,_["c"].service("tables").find({query:{tableDb:"cacemdb",tableName:"formulaires",query:JSON.stringify({query:{uid:"c1fe350f-95d2-4996-93a6-c03a7545b883"}})}});case 22:n=t.sent,console.log("INFOS Formulaire associé Demande Parking :",n),e.lieuAcces=["PARKING","RDC","GPU","GCD"],e.editRow=m.reduce((function(e,t){return e[t]="",e}),{}),f=[],s.forEach((function(t,n){if(f.push({orig:Object.keys(t).length,col:Object.keys(e.editRow).length,obbj:e.objectsNotIn(t,e.editRow)}),e.objectsNotIn(t,e.editRow).length>0){var a=e.objectsNotIn(t,e.editRow).reduce((function(e,t){return e[t]="",e}),{});e.editRow=Object.assign(e.editRow,a)}})),console.log("New edit row :",e.editRow),m=Object.keys(e.editRow),e.newColumns=m.map((function(e){return{name:e,align:"center",label:e,field:e,sortable:!0}})),console.log("NEw Columns :",e.editRow),console.log("COLONNES  COMP : ",f),e.labelsColumns&&e.labelsColumns.length>0?(console.log("Label :",e.labelsColumns),console.log("Columns :",e.newColumns),e.labelsColumns.forEach((function(t,n){if(t.id&&t.label){var a=e.newColumns.findIndex((function(e){return e.name==t.id}));console.log("Index :",a),-1!=a&&(e.newColumns[a].label=t.label)}}))):n&&1==n.length&&a?(e.datesFields=[],a.forEach((function(t,n){if(-1!=e.newColumns.findIndex((function(e){return e.name==t.id}))){var a=e.newColumns.findIndex((function(e){return e.name==t.id}));e.newColumns[a].label=String(t.label).trim().replace(":",""),"date"==t.field_type&&e.datesFields.push(t.id)}})),console.log("Champs types date :",e.datesFields),console.log(" Form Columns :",e.newColumns)):(p=Object.assign([],e.newColumns.map((function(e){return{id:e.name,label:e.name}}))),p.forEach((function(t,n){if(t.id&&t.label){var a=e.newColumns.findIndex((function(e){return e.name==t.id}));e.newColumns[a].label=t.label}})),console.log("Columns :",e.newColumns)),e.visibleColumns=Object.assign([],e.newColumns),console.log("Visible columns :",e.visibleColumns),!e.hideid||e.editable&&e.selectable?(h=Object.assign([],e.visibleColumns.map((function(e){return"".concat(e.field.trim())}))),e.visibleColumns=Object.assign([],h),console.log("Visible columns :",e.visibleColumns)):(b=Object.assign([],e.visibleColumns.filter((function(e){return"_id"!=e.field})).map((function(e){return"".concat(e.field.trim())}))),e.visibleColumns=Object.assign([],b),console.log("Visible columns :",e.visibleColumns)),null!==e.filters&&0!==e.filters.length||(e.filters=e.visibleColumns.reduce((function(e,t){return e[t]="",e}),{})),null!==e.filtersParams&&0!==e.filtersParams.length||(e.filtersParams=e.visibleColumns.reduce((function(e,t){return e[t]={},e}),{})),console.log("Table result info parking :",s.filter((function(e){return"PARKING"==e.typeacces}))),console.log("Filters :",e.filters),console.log("Filters Params:",e.filtersParams),e.customFilter=e.filterArray(s,e.filters),console.log("Custom filter :",e.customFilter);case 44:case"end":return t.stop()}}),t)})))()},deletedRow:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.selected.length){t.next=7;break}return t.next=3,e.$store.dispatch("tables/remove",[e.selected[0]._id,{query:{tableDb:e.dbtype,tableName:e.dbname}}]);case 3:return n=t.sent,console.log("Deleted row :",n),t.next=7,e.updateDatas();case 7:case"end":return t.stop()}}),t)})))()},showTimeLine:function(){console.log("Visiteurs du jour :",this.visiteursDuJour),this.$q.dialog({component:S["a"],visiteursJour:this.visiteursDuJour,twidth:"70%"}).onOk(function(){var e=r()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("OK timeline");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))},supPrevBtn:function(){var e=this;this.$q.dialog({title:"Confirmation",message:"Vous allez supprimer définitivement cette ligne ?",ok:{push:!0,label:"Oui",color:"negative"},cancel:{push:!0,label:"Non"},persistent:!0}).onOk(r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.deletedRow();case 2:case"end":return t.stop()}}),t)})))).onCancel((function(){})).onDismiss((function(){}))}}),beforeMount:function(){var e=this;console.log("Store context",this.$store);var t=this.$FeathersVuex.api.Table;this.dbtype&&this.dbname?t.find({query:{tableDb:this.dbtype,tableName:this.dbname,query:JSON.stringify({})}}).then(function(){var t=r()(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("Table :",n),console.log("DbName :",e.dbname),e.data=Object.assign([],n.map((function(e){return Object(e).hasOwnProperty("etat")?l()({},e):l()(l()({},e),{},{etat:""})})).filter((function(e){return"attente"!=e.etat&&"efface"!=e.etat&&"sortie"!=e.etat}))).map((function(e){return Object.assign({},l()({},e),{contactinterne:String(e.contactinterne).split("[")[0].trim()})})).sort((function(e,t){var n=p["b"].formatDate(e.datevisite,"YYYYMMDD"),a=p["b"].formatDate(t.datevisite,"YYYYMMDD");return n<a?1:-1})),t.next=5,e.updateDatas();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.data=Object.assign([],this.datas),this.filterTypeAcces("RDC")},mounted:function(){var e=this;this.dbtype&&this.dbname?Table.find({query:{tableDb:this.dbtype,tableName:this.dbname,query:JSON.stringify({})}}).then(function(){var t=r()(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("Table :",n),console.log("DbName :",e.dbname),e.data=Object.assign([],n.map((function(e){return Object(e).hasOwnProperty("etat")?l()({},e):l()(l()({},e),{},{etat:""})})).filter((function(e){return"attente"!=e.etat&&"efface"!=e.etat&&"sortie"!=e.etat}))).map((function(e){return Object.assign({},l()({},e),{contactinterne:String(e.contactinterne).split("[")[0].trim()})})).sort((function(e,t){var n=p["b"].formatDate(e.datevisite,"YYYYMMDD"),a=p["b"].formatDate(t.datevisite,"YYYYMMDD");return n<a?1:-1})),t.next=5,e.updateDatas();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.data=Object.assign([],this.datas),this.filterTypeAcces("RDC")},watch:{scope:{handler:function(e){console.log("SCOPE EVENT :",e)}},selected:function(){console.log("Selection :",this.selected),this.selected.length>0&&(Object.assign(this.selectedRow,this.selected[0]),this.$emit("row-click","case à cocher",this.selectedRow))},data:function(){console.log("Table data:",this.data)},selectedRow:function(){console.log("Changement de données")}},errorCaptured:function(e,t,n){console.log("Error :",error),console.log("Vm component :",t),console.log("Info :",n)}}),F=j,P=n("2877"),T=n("ee89"),E=n("eaac"),M=n("bd08"),N=n("357e"),Q=n("42a1"),$=n("ddd8"),I=n("27f9"),V=n("0016"),J=n("db86"),Y=n("8f8e"),U=n("2c91"),B=n("cb32"),L=n("eb85"),z=n("f20b"),K=n("1c1c"),G=n("66e5"),H=n("4074"),W=n("0170"),X=n("7cbe"),Z=n("52ee"),ee=n("24e8"),te=n("f09f"),ne=n("65c6"),ae=n("6ac5"),se=n("a370"),ie=n("4b7e"),re=n("7f67"),oe=n("eebe"),le=n.n(oe),ce=Object(P["a"])(F,h,g,!1,null,null,null),ue=ce.exports;le()(ce,"components",{QUploader:T["a"],QBtn:D["a"],QTable:E["a"],QTr:M["a"],QTh:N["a"],QPopupEdit:Q["a"],QSelect:$["a"],QInput:I["a"],QIcon:V["a"],QTd:J["a"],QCheckbox:Y["a"],QSpace:U["a"],QAvatar:B["a"],QSeparator:L["a"],QBtnDropdown:z["a"],QList:K["a"],QItem:G["a"],QItemSection:H["a"],QItemLabel:W["a"],QPopupProxy:X["a"],QDate:Z["a"],QTooltip:k["a"],QDialog:ee["a"],QCard:te["a"],QToolbar:ne["a"],QToolbarTitle:ae["a"],QCardSection:se["a"],QCardActions:ie["a"]}),le()(ce,"directives",{ClosePopup:re["a"]});var de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row q-col-gutter-sm"},[a("f-vv-form",{attrs:{title:"accueil",hiddenFields:[]}}),a("q-dialog",{model:{value:e.showUserInfos,callback:function(t){e.showUserInfos=t},expression:"showUserInfos"}},[a("q-card",[a("q-toolbar",{staticClass:"text-primary"},[a("div",{staticClass:"q-pt-xs"},[a("img",{attrs:{src:n("056e")}})]),a("q-toolbar-title",[e._v(" Sélection de l'heure de sortie  ")]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(t){e.showUserInfos=!1}}})],1),a("q-card-section",[a("div",{staticClass:"text-h6 text-center"},[e._v("Heure de Sortie du visiteur "+e._s(Object(e.selectedUser).hasOwnProperty("prenom")&&Object(e.selectedUser).hasOwnProperty("nom")?e.selectedUser["prenom"]+" "+e.selectedUser["nom"]:""))])]),a("q-card-section",{staticClass:"text-center"},[a("q-time",{attrs:{format24h:"","now-btn":""},model:{value:e.selectedUser.heuresortie,callback:function(t){e.$set(e.selectedUser,"heuresortie",t)},expression:"selectedUser.heuresortie"}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Memoriser",color:"primary"},on:{click:function(t){return e.saveOutTime(e.selectedUser.heuresortie)}}})],1)],1)],1)],1)},me=[],fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[e.show_ExcelImport?n("div",{staticClass:"row fit q-pb-md items-right justify-right full-width"},[n("q-uploader",{ref:"uploader",staticClass:"full-width q-px-none",attrs:{multiple:!1,"hide-upload-btn":!0,square:"",outlined:"",label:"Sélectionner un fichier excel",type:"file"},on:{added:e.onChange}}),e.currentFile.name?n("q-btn",{attrs:{color:"primary","text-color":"white",label:"Utiliser comme base de donnée"},on:{click:function(t){return e.saveToDatabase()}}}):e._e()],1):e._e(),n("q-table",{ref:"myTable",attrs:{id:"myTable",title:e.setTitle,data:e.datas?e.datas:e.liveDatas,"row-key":function(e){return e._id?e._id:e[Object.keys(e)[0]]},selection:e.useSelection,columns:e.newColumns,filter:e.filter,"no-data-label":"pas de données pour l'instant...","no-results-label":"Aucun résultat trouvé",selected:e.useSelected,"visible-columns":e.visibleColumns,pagination:e.initialPagination,separator:"cell"},on:{"row-click":e.rowSelect,"update:selected":function(t){e.useSelected=t}},scopedSlots:e._u([{key:"header",fn:function(t){return[n("q-tr",{attrs:{props:t}},[e.selectable||e.editable?n("q-th",{staticClass:"text-bold text-primary bg-blue-1"}):e._e(),e._l(t.cols,(function(a){return n("q-th",{key:a.name,staticClass:"text-bold text-primary bg-blue-1",attrs:{props:t}},[e.selectable||e.editable?n("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Filtre",icon:"filter_alt"}},[n("q-popup-edit",{ref:"filter_"+a.name,refInFor:!0,attrs:{cover:!1,offset:[0,2]},scopedSlots:e._u([{key:"default",fn:function(t){return[e.datesFields.includes(a.name)?n("div",{staticClass:"q-pa-none",staticStyle:{width:"180px"}},[n("div",{staticClass:"text-body2 text-grey q-mb-md"},[e._v("\n                    Critère de filtre ["+e._s(a.name)+"]\n                  ")]),n("div",{staticClass:"row items-center"},[n("div",{staticClass:"q-pa-none text-caption text-dark full-width"},[n("q-select",{attrs:{dense:"",filled:"",options:["annee","mois","jour"],label:"Date par"},model:{value:e.filtersParams[a.name].option,callback:function(t){e.$set(e.filtersParams[a.name],"option",t)},expression:"filtersParams[col.name].option"}})],1),n("div",{staticClass:"col-12 q-pa-none"},[n("q-input",{attrs:{dense:""},model:{value:e.filtersParams[a.name].value,callback:function(t){e.$set(e.filtersParams[a.name],"value",t)},expression:"filtersParams[col.name].value"}})],1),n("div",{staticClass:"q-pa-sm q-gutter-md"},[n("q-btn",{staticStyle:{"min-width":"68px"},attrs:{dense:"","no-caps":"",color:"primary",size:"sm",label:"Filtrer"},on:{click:function(n){return e.updateFilters(t,a.name)}}}),n("q-btn",{staticStyle:{"min-width":"68px"},attrs:{dense:"","no-caps":"",color:"grey-7",size:"sm",label:"Effacer"},on:{click:function(n){return e.deleteFilters(t,a.name)}}})],1)])]):e._e()]}}],null,!0),model:{value:e.filtersParams[a.name],callback:function(t){e.$set(e.filtersParams,a.name,t)},expression:"filtersParams[col.name]"}})],1):e._e(),e._v(e._s(String(a.label).toUpperCase())+"\n          ")],1)}))],2)]}},{key:"body-cell",fn:function(t){return[n("q-td",{staticClass:"q-pa-none",attrs:{props:t}},[e.ifJSON(t.value)?n("json-viewer",{attrs:{value:t.value}}):n("div",{staticClass:"q-pa-none inline cursor-pointer"},[n("div",{staticClass:"\n                q-pa-none\n                fit\n                flex flex-center\n                text-center\n                non-selectable\n                q-pa-md\n              "},[e._v("\n              "+e._s(t.value)+"\n            ")])])],1)]}},{key:"top-left",fn:function(t){return[n("div",{staticClass:"text-h6"},[e._v(e._s(""!=e.currentAcces?e.setTitle+" ["+e.currentAcces+"]":""+e.setTitle))]),n("div",{staticClass:"row q-gutter-sm q-py-md"},[e.useAdmin&&!e.hideexcel?n("q-btn",{staticClass:"q-px-sm",attrs:{color:"primary",dense:"","no-caps":""},on:{click:function(t){e.show_ExcelImport=!0}}},[n("q-icon",{attrs:{size:"0.9em",name:"far fa-file-excel"}}),n("q-icon",{attrs:{size:"0.9em",name:"fas fa-arrow-right"}}),n("q-icon",{attrs:{size:"0.9em",name:"fas fa-database"}}),n("div",{staticClass:"q-px-sm"},[e._v("Excel Init")])],1):e._e(),0!=e.newColumns.length&&e.showAdd?n("q-btn",{staticClass:"q-px-sm",attrs:{color:"primary",dense:"","no-caps":""},on:{click:function(t){e.show_AddDialog=!0}}},[e._v("Ajouter")]):e._e(),n("q-dialog",{model:{value:e.show_AddDialog,callback:function(t){e.show_AddDialog=t},expression:"show_AddDialog"}},[n("q-card",[n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("Ajouter un element!")])]),n("q-card-section",[n("div",{staticClass:"row"},e._l(e.newColumns,(function(t,a){return n("div",{key:"key-"+a,staticClass:"col-12"},[n("q-input",{attrs:{label:t.name},model:{value:e.editRow[""+t.name],callback:function(n){e.$set(e.editRow,""+t.name,n)},expression:"editRow[`${item.name}`]"}})],1)})),0)]),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"},on:{click:function(t){e.show_AddDialog=!1}}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.addRow}})],1)],1)],1)],1),n("div",{staticClass:"row q-gutter-md q-pb-md"},[n("q-btn",{staticClass:"q-px-md text-subtitle2 text-bold text-primary",attrs:{dense:"","no-caps":"",outline:""}},[e._v("\n            Les visites entre le\n            "+e._s(Object(e.dateRange).hasOwnProperty("from")?e.dateRange.from:null)+"\n            et le\n            "+e._s(Object(e.dateRange).hasOwnProperty("to")?e.dateRange.to:null)+"\n            "),n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{locale:e.myLocale,mask:"DD/MM/YYYY",range:"",minimal:""},on:{"range-end":function(t){return e.filterRangeDate(e.dateRange)}},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}},[n("div",{staticClass:"row items-center justify-end"},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Fermer",color:"primary",flat:""}})],1)])],1),n("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n              Cliquez-ici pour voir les visites entre 2 dates\n            ")])],1),n("q-btn",{staticClass:"q-px-md text-subtitle2 text-bold text-primary",attrs:{dense:"","no-caps":"",outline:"",label:"Visites pour la date (cliquez-ici)"}},[n("q-popup-proxy",{ref:"btnDatej",attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{locale:e.myLocale,mask:"DD/MM/YYYY",minimal:""},on:{input:function(t){e.filterDateVisite(e.dateSelected),e.$refs.btnDatej.hide()}},model:{value:e.dateSelected,callback:function(t){e.dateSelected=t},expression:"dateSelected"}})],1),n("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n              Cliquez-ici pour voir les visites pour une date précise\n            ")])],1),n("q-btn",{attrs:{dense:"",color:"primary","no-caps":"",label:"Effacer les filtres"},on:{click:function(t){e.currentAcces="",e.customFilter=""}}},[n("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n              Cliquez-ici pour effacer les filtres\n            ")])],1)],1),n("div",{staticClass:"row q-gutter-md q-pb-md"},[n("q-btn-dropdown",{attrs:{dense:"",color:"primary",label:"Lieu"}},e._l(e.lieuAcces,(function(t){return n("q-list",{key:"lieu-"+t},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(n){return e.filterTypeAcces(t)}}},[n("q-item-section",[n("q-item-label",[e._v(e._s(t))])],1)],1)],1)})),1)],1),e.hideexcel?e._e():n("div",{staticClass:"row q-gutter-md q-pb-md"},[n("q-btn",{staticClass:"bg-primary",attrs:{dense:"",flat:"","no-caps":"","text-color":"white",icon:"far fa-file-excel",label:".xlsx"},on:{click:function(t){return e.exportDatasExcel()}}}),n("q-btn",{staticClass:"bg-primary",attrs:{dense:"","no-caps":"",flat:"","text-color":"white",icon:"fas fa-file-csv",label:".csv"},on:{click:function(t){return e.exportCsvTable()}}}),n("q-btn",{staticClass:"bg-primary",attrs:{dense:"","no-caps":"",flat:"",filled:"","text-color":"white",icon:"far fa-file-pdf",label:".pdf"},on:{click:function(t){return e.exportDatasPdf()}}})],1)]}},{key:"top-right",fn:function(t){return[n("div",{staticClass:"row q-gutter-sm"},[n("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Recherche","label-color":"text-dark"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[n("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),n("q-select",{staticStyle:{"min-width":"150px"},attrs:{multiple:"",outlined:"",dense:"","options-dense":"","display-value":e.$q.lang.table.columns,"emit-value":"","map-options":"",options:e.newColumns,"option-value":"name","options-cover":""},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}}),n("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}})],1)]}},e.selected&&e.selected.length>0?{key:"bottom-row",fn:function(){return[n("q-tr",[n("q-td",{staticClass:"q-pa-md",attrs:{colspan:"100%"}},[e.selected&&e.selected.length>0&&e.editable?n("q-btn",{staticClass:"q-px-md q-mx-sm",attrs:{color:"red",dense:"","no-caps":""},on:{click:e.supPrevBtn}},[e._v("Supprimer")]):e._e(),e.selected&&e.selected.length>0&&e.editable?n("q-btn",{staticClass:"q-px-md q-mx-sm",attrs:{color:"grey-8",dense:"","no-caps":""},on:{click:function(t){e.show_EditDialog=!0}}},[e._v("Modifier")]):e._e(),n("q-dialog",{model:{value:e.show_EditDialog,callback:function(t){e.show_EditDialog=t},expression:"show_EditDialog"}},[n("q-card",{staticStyle:{width:"80%","max-width":"100%"}},[n("q-toolbar",{staticClass:"text-white  full-width bg-blue"},[n("q-toolbar-title",{staticClass:"text-h5"},[e._v(" Modification ! ")]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),n("q-card-section",{staticClass:"q-pa-md",staticStyle:{width:"100%","max-width":"100%"}},[n("f-vv-form",{ref:"editForm",staticClass:"q-pa-sm",attrs:{title:""+e.dbname.split("dbf_")[1],fieldsmodel:e.selectedRow}})],1),n("q-card-actions",{staticClass:"q-px-xl q-py-md",attrs:{align:"center"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"},on:{click:function(t){e.show_EditDialog=!1}}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.updateRow}})],1)],1)],1)],1)],1)]},proxy:!0}:null],null,!0)})],1)},pe=[],be=Object(c["d"])({components:{FVvForm:O["a"]},name:"FAcceuilTable",data:function(){var e={days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_"),firstDayOfWeek:0};return{myLocale:e,dateSelected:"",currentAcces:"",lieuAcces:[],data:[],currentFile:{},show_ExcelImport:!1,initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:5},visibleColumns:[],show_AddDialog:!1,show_EditDialog:!1,newColumns:[],editRow:{},selected:[],selectedRow:{},dateRange:{},filter:"",filters:{},filtersParams:{},filtersOperator:{},datesFields:[],customFilter:null}},props:{dbname:{type:String,required:!1},dbtype:{type:String,default:"mongodb",required:!1},datas:{type:Array,required:!1},columns:{type:Array,required:!1},labelsColumns:{type:Array,default:null,required:!1},editable:{type:Boolean,default:!0,required:!1},hideid:{type:Boolean,default:!0,required:!1},hideexcel:{type:Boolean,default:!0,required:!1},titre:{type:String,default:"",required:!1},useAdmin:{type:Boolean,default:!1,required:!1},selectable:{type:Boolean,default:!1,required:!1},showAdd:{type:Boolean,default:!1,required:!1}},computed:{setTitle:function(){return""==this.titre?this.dbname:this.titre},liveDatas:function(){return this.dbtype||this.dbname?Array.isArray(this.customFilter)?this.customFilter:x()(this.data):x()(this.datas)},useSelection:function(){return this.editable||this.selectable?"single":"none"},useSelected:{get:function(){return this.editable||this.selectable?this.selected:[]},set:function(e){this.selected=e}}},methods:l()(l()({filterArray:function(e,t){var n=Object.keys(t);return e.filter((function(e){return n.every((function(n){return"function"!==typeof t[n]||t[n](e[n])}))}))},ifJSON:function(e){try{return!("[object Object]"!==Object.prototype.toString.call(e)&&!Array.isArray(e))}catch(error){return!1}},onChange:function(e){var t=this,n=e?e[0]:null;console.log("File :",n),this.currentFile=n;var a=n;console.log("Files data :",a);var s=new FileReader;s.onload=function(e){var n=e.target.result,a=y["read"](n,{type:"binary",cellDates:!0}),s=a.SheetNames[0],i=a.Sheets[s];t.data&&(t.data=y["utils"].sheet_to_json(i,{header:0,raw:!0})),console.log("Datas :",t.data);var r=y["utils"].sheet_to_json(i,{header:1,raw:!0});if(console.log("Datas headers :",r),console.log("Datas with header :",r.length),Array.isArray(r)&&r.length>0){t.newColumns=[],console.log("Keys headers :",JSON.parse(JSON.stringify(r[0])));var o=JSON.parse(JSON.stringify(r[0])),l=o.map((function(e){return"".concat(String(e).trim())}));console.log("Keys headers :",l),t.visibleColumns=l,o.forEach((function(e){"string"==typeof e&&t.newColumns.push({name:e,field:e,label:e,sortable:!0})}))}},s.readAsBinaryString(n)},saveToDatabase:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object.assign([],e.data),a=[],e.data=Object.assign([],a),Array.isArray(n)){t.next=5;break}return t.abrupt("return");case 5:n.forEach(function(){var t=r()(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_["c"].service("tables").create(JSON.parse(JSON.stringify(n)),{query:{tableDb:e.dbtype,tableName:e.dbname}});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n.length>0&&(s=Object.keys(n[0]),console.log("Columns :",s),e.editRow=s.reduce((function(e,t){return e[t]="",e}),{}),e.newColumns=s.map((function(e){return{name:e,align:"center",label:e,field:e,sortable:!0}}))),e.visibleColumns=Object.assign([],e.newColumns),e.hideid&&(e.visibleColumns=Object.assign([],e.visibleColumns.filter((function(e){return"_id"!=e.field})).map((function(e){return"".concat(e.field.trim())}))),console.log("Visible columns :",e.visibleColumns)),setTimeout(r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.updateDatas();case 2:e.show_ExcelImport=!1;case 3:case"end":return t.stop()}}),t)}))),1e3);case 10:case"end":return t.stop()}}),t)})))()},exportDatasExcel:function(){var e=this;Promise.resolve().then(n.t.bind(null,"1146",7)).then((function(t){var n,a,s;if(s=e.data,e.newColumns.length>0){var i=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),i.push(s)})),n=e.newColumns,a=i}else{var r=[];e.newColumns.forEach((function(e){var t={title:e.name,dataKey:e.field};"Actions"!=e.name&&r.push(t)})),console.log("Columns :",r),n=r;var o=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),o.push(s)})),a=o}a.map((function(e){return delete e._id,e}));var l=[n.filter((function(e){return"_id"!=e.name})).map((function(e){return e.name}))],c=y["utils"].book_new();t.utils.sheet_add_aoa(c,l);var u=t.utils.sheet_add_json(c,a,{origin:"A2",skipHeader:!0}),d={Sheets:{data:u},SheetNames:["data"]},m=t.write(d,{bookType:"xlsx",type:"array"}),f=Object(A["a"])("table-export.xlsx",m,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8");!0!==f&&e.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}))},exportDatasPdf:function(){var e=this;Promise.resolve().then(n.t.bind(null,"0da4",7)).then((function(t){var n,a,s=new C["jsPDF"];if(e.newColumns.length>0){var i=[];e.data.forEach((function(t,n,a){var s=[];e.newColumns.forEach((function(e,n,a){"_id"!=e.field&&s.push(t[e.field])})),console.log("données exportables:",s),i.push(s)}));var r=Object.assign([],e.newColumns);delete r._id,n=[r.filter((function(e){return"_id"!=e.name})).map((function(e){return e.name}))],a=i}console.log("Columns :",n),console.log("Body :",a),s.autoTable({head:n,body:a}),s.save("export-table.pdf")}))},exportCsvTable:function(){var e=this;Promise.resolve().then(n.t.bind(null,"1146",7)).then((function(t){var n,a,s;if(s=e.data,e.newColumns.length>0){var i=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),i.push(s)})),n=e.newColumns,a=i}else{var r=[];e.newColumns.forEach((function(e){var t={title:e.name,dataKey:e.field};"Actions"!=e.name&&r.push(t)})),console.log("Columns :",r),n=r;var o=[];s.forEach((function(t,n,a){var s={};e.newColumns.forEach((function(e,n,a){s[e.name]=t[e.field]})),console.log("données exportables:",s),o.push(s)})),a=o}a.map((function(e){return delete e._id,e}));var l=[n.filter((function(e){return"_id"!=e.name})).map((function(e){return e.name}))],c=y["utils"].book_new();t.utils.sheet_add_aoa(c,l);var u=t.utils.sheet_add_json(c,a,{origin:"A2",skipHeader:!0}),d=t.utils.sheet_to_csv(u,{FS:","}),m=Object(A["a"])("table-export.csv",d,"text/csv");!0!==m&&e.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}))},rowSelect:function(e,t,n){this.$emit("row-click",e,t,n)}},Object(u["b"])("tables",{getDatas:"getTableQuery"})),{},{whereDateYearEq:function(e){return function(t){return t.split("/")[2]===e}},whereDateMonthrEq:function(e){return function(t){return t.split("/")[2]===e}},whereDateDayEq:function(e){return function(t){return t.split("/")[2]===e}},whereContain:function(e){return function(t){return-1!=String(t).indexOf(e)}},whereDateBetween:function(e,t){return function(n){return p["b"].isBetweenDates(new Date(n.split("/")[2],n.split("/")[1],n.split("/")[0]),new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]),new Date(t.split("/")[2],t.split("/")[1],t.split("/")[0]),{onlyDate:!0,inclusiveFrom:!0,inclusiveTo:!0})}},whereDateDuJour:function(e){var t=new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]);return function(e){return p["b"].isSameDate(new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]),t)}},whereTypeAcces:function(e){return function(t){return String(t).trim()==e}},filterRangeDate:function(e){console.log("test datesel",e),e&&Object(e).hasOwnProperty("from")&&Object(e).hasOwnProperty("to")&&(console.log("test datesel 1 :",e),e.from&&e.to&&(this.filters["datevisite"]=this.whereDateBetween(e.from,e.to),console.log("filtre :",this.filters["datevisite"]),this.customFilter=this.filterArray(this.data,this.filters)))},filterDateVisite:function(e){e&&(this.filters["datevisite"]=this.whereDateDuJour(e),this.customFilter=this.filterArray(this.data,this.filters))},filterTypeAcces:function(e){e&&(this.currentAcces=e,this.filters["typeacces"]=this.whereTypeAcces(e),this.customFilter=this.filterArray(this.data,this.filters))},updateFilters:function(e,t){console.log("Object SCOPE :",e),Object(e.value).hasOwnProperty("option")&&(e.value.option&&"annee"===e.value.option&&(this.filters["".concat(t)]=""!=e.value.value?this.whereDateYearEq(e.value.value):""),e.value.option&&"mois"===e.value.option&&(this.filters["".concat(t)]=""!=e.value.value?this.whereDateMonthEq(e.value.value):""),e.value.option&&"jour"===e.value.option&&(this.filters["".concat(t)]=""!=e.value.value?this.whereDateDayEq(e.value.value):"")),console.log("Filters :",this.filters),console.log("Filters Params:",this.filtersParams),console.log("Colonne filtre update :",t),this.customFilter=this.filterArray(this.data,this.filters),e.set()},deleteFilters:function(e,t){this.filters["".concat(t)]="",this.customFilter=this.filterArray(this.data,this.filters),this.filtersParams["".concat(t)].value="",e.set()},addRow:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=e.newColumns.length){t.next=2;break}return t.abrupt("return");case 2:return console.log("Edit rows :",e.editRow),t.next=5,e.$store.dispatch("tables/create",[e.editRow,{query:{tableDb:e.dbtype,tableName:e.dbname}}]);case 5:return n=t.sent,console.log("Added row :",n),t.next=9,e.updateDatas();case 9:case"end":return t.stop()}}),t)})))()},updateRow:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("Edit rows :",e.selectedRow),delete e.$refs["editForm"].fieldData._id,console.log("Form datas :",e.$refs["editForm"].fieldData),!e.selectedRow){t.next=10;break}return t.next=6,_["c"].service("tables").update(e.selectedRow._id,e.$refs["editForm"].fieldData,{query:{tableDb:e.dbtype,tableName:e.dbname}});case 6:return n=t.sent,console.log("Données modifiées :",n),t.next=10,e.updateDatas();case 10:case"end":return t.stop()}}),t)})))()},updateDatas:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n,a,s,i,r,o,l,c,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_["c"].service("tables").find({query:{tableDb:e.dbtype,tableName:e.dbname,query:JSON.stringify({query:{}})}});case 2:if(s=t.sent,console.log("Table result :",s),e.data=Object.assign([],s),!(e.data.length>0)){t.next=21;break}return i=s.map((function(e){return"".concat(Object.keys(e).length)})),console.log("Count keys :",i),r=Math.max.apply(Math,x()(i)),console.log("Nb max props :",r),o=i.findIndex((function(e){return Number(e)==Number(r)})),l=Object.keys(e.data[o]),console.log("Columns :",l),t.next=15,_["c"].service("tables").find({query:{tableDb:e.dbtype,tableName:"formulaires",query:JSON.stringify({query:{nom:"".concat(e.dbname.split("dbf_")[1])}})}});case 15:n=t.sent,console.log("INFOS Formulaire associé ".concat(e.dbname.split("dbf_")[1],":"),n),n&&1==n.length&&Array.isArray(n[0].data)&&(a=n[0].data,l=a.map((function(e){return"".concat(e.id)})),e.lieuAcces=a.filter((function(e){return"typeacces"==e.id}))[0].field_options.options.map((function(e){return"".concat(e.label)}))),e.editRow=l.reduce((function(e,t){return e[t]="",e}),{}),e.newColumns=l.map((function(e){return{name:e,align:"center",label:e,field:e,sortable:!0}})),e.labelsColumns&&e.labelsColumns.length>0?(console.log("Label :",e.labelsColumns),console.log("Columns :",e.newColumns),e.labelsColumns.forEach((function(t,n){if(t.id&&t.label){var a=e.newColumns.findIndex((function(e){return e.name==t.id}));console.log("Index :",a),-1!=a&&(e.newColumns[a].label=t.label)}}))):n&&1==n.length&&a?(e.datesFields=[],a.forEach((function(t,n){if(-1!=e.newColumns.findIndex((function(e){return e.name==t.id}))){var a=e.newColumns.findIndex((function(e){return e.name==t.id}));e.newColumns[a].label=String(t.label).trim().replace(":",""),"date"==t.field_type&&e.datesFields.push(t.id)}})),console.log("Champs types date :",e.datesFields),console.log(" Form Columns :",e.newColumns)):(c=Object.assign([],e.newColumns.map((function(e){return{id:e.name,label:e.name}}))),c.forEach((function(t,n){if(t.id&&t.label){var a=e.newColumns.findIndex((function(e){return e.name==t.id}));e.newColumns[a].label=t.label}})),console.log("Columns :",e.newColumns));case 21:e.visibleColumns=Object.assign([],e.newColumns),console.log("Visible columns :",e.visibleColumns),!e.hideid||e.editable&&e.selectable?(d=Object.assign([],e.visibleColumns.map((function(e){return"".concat(e.field.trim())}))),e.visibleColumns=Object.assign([],d),console.log("Visible columns :",e.visibleColumns)):(u=Object.assign([],e.visibleColumns.filter((function(e){return"_id"!=e.field})).map((function(e){return"".concat(e.field.trim())}))),e.visibleColumns=Object.assign([],u),console.log("Visible columns :",e.visibleColumns)),e.filters=e.visibleColumns.reduce((function(e,t){return e[t]="",e}),{}),e.filtersParams=e.visibleColumns.reduce((function(e,t){return e[t]={},e}),{}),console.log("Filters :",e.filters),console.log("Filters Params:",e.filtersParams),e.customFilter=e.filterArray(e.data,e.filters),console.log("Custom filter :",e.customFilter);case 30:case"end":return t.stop()}}),t)})))()},deletedRow:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.selected.length){t.next=7;break}return t.next=3,e.$store.dispatch("tables/remove",[e.selected[0]._id,{query:{tableDb:e.dbtype,tableName:e.dbname}}]);case 3:return n=t.sent,console.log("Deleted row :",n),t.next=7,e.updateDatas();case 7:case"end":return t.stop()}}),t)})))()},supPrevBtn:function(){var e=this;this.$q.dialog({title:"Confirmation",message:"Vous allez supprimer définitivement cette ligne ?",ok:{push:!0,label:"Oui",color:"negative"},cancel:{push:!0,label:"Non"},persistent:!0}).onOk(r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.deletedRow();case 2:case"end":return t.stop()}}),t)})))).onCancel((function(){})).onDismiss((function(){}))}}),beforeMount:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("Store context",e.$store),n=e.$FeathersVuex.api.Table,!e.dbtype||!e.dbname){t.next=9;break}return n.find({query:{tableDb:e.dbtype,tableName:e.dbname,query:JSON.stringify({})}}).then((function(e){console.log("Table :",e)})),console.log("DbName :",e.dbname),t.next=7,e.updateDatas();case 7:t.next=10;break;case 9:e.data=Object.assign([],e.datas);case 10:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("Table :",e.data),e.$root.$on("changeDate",(function(e){console.log("Selection de la date :",e)})),Array.isArray(e.columns)&&e.columns.length>0?(e.editRow=e.columns.reduce((function(e,t){return e[t]="",e}),{}),console.log("Edit rows :",e.editRow),e.newColumns=e.columns.map((function(e){return{name:e,align:"center",label:e,field:e,sortable:!0}}))):(e.data.length>0&&(n=Object.keys(e.data[0]),console.log("Columns :",n),e.editRow=n.reduce((function(e,t){return e[t]="",e}),{}),e.newColumns=n.map((function(e){return{name:e,align:"center",label:e,field:e,sortable:!0}}))),e.visibleColumns=Object.assign([],e.newColumns),e.hideid&&(e.visibleColumns=Object.assign([],e.visibleColumns.filter((function(e){return"_id"!=e.field})).map((function(e){return"".concat(e.field.trim())}))),console.log("Visible columns :",e.visibleColumns)));case 3:case"end":return t.stop()}}),t)})))()},watch:{scope:{handler:function(e){console.log("SCOPE EVENT :",e)}},selected:function(){console.log("Selection :",this.selected),this.selected.length>0&&(Object.assign(this.selectedRow,this.selected[0]),this.$emit("row-click","case à cocher",this.selectedRow))},data:function(){console.log("Table data:",this.data)},selectedRow:function(){console.log("Changement de données")}},errorCaptured:function(e,t,n){console.log("Error :",error),console.log("Vm component :",t),console.log("Info :",n)}}),he=be,ge=n("4e73"),ve=Object(P["a"])(he,fe,pe,!1,null,null,null),we=ve.exports;le()(ve,"components",{QUploader:T["a"],QBtn:D["a"],QTable:E["a"],QTr:M["a"],QTh:N["a"],QMenu:ge["a"],QPopupEdit:Q["a"],QSelect:$["a"],QInput:I["a"],QTd:J["a"],QTooltip:k["a"],QIcon:V["a"],QDialog:ee["a"],QCard:te["a"],QCardSection:se["a"],QCardActions:ie["a"],QPopupProxy:X["a"],QDate:Z["a"],QBtnDropdown:z["a"],QList:K["a"],QItem:G["a"],QItemSection:H["a"],QItemLabel:W["a"],QToolbar:ne["a"],QToolbarTitle:ae["a"]}),le()(ve,"directives",{ClosePopup:re["a"]});var qe=n("148b"),xe=Object(c["d"])({components:{FAcceuilTable:we,FVvForm:O["a"]},name:"FAccueil",data:function(){return{tvue:"formulaire",splitterModel:15,showUserInfos:!1,selectedUser:{}}},props:{title:{type:String,required:!1}},computed:l()({},Object(u["d"])("adinfos",{isAdmin:function(e){return e.isAdmin},isSiteAdmin:function(e){return e.isSiteAdmin}})),methods:{initHFields:function(){console.log("Form init :",this)},onRowClick:function(e,t){console.log("Ligne sélectionnée : ",e,t),t&&(this.selectedUser=t,"case à cocher"!=e&&(this.showUserInfos=!0),console.log("Table ref :",this.$refs.myTable))},saveOutTime:function(e){var t=this;return r()(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$q.loading.show({spinner:qe["a"],spinnerColor:"primary",message:"Enregistrement de l'heure de sortie.."}),e.next=3,_["c"].service("tables").update(t.selectedUser._id,t.selectedUser,{query:{tableDb:"db_regvisiteurs",tableName:"dbf_"+t.title}});case 3:return n=e.sent,console.log("Données modifiées :",n),e.next=7,t.$refs.myTable.updateDatas();case 7:t.$q.loading.hide();case 8:case"end":return e.stop()}}),e)})))()}},watch:{tvue:{handler:function(e){console.log("Changement de MENU :",e)}}}}),ye=xe,Ce=(n("31c3"),n("ca78")),_e=n("7460"),De=Object(P["a"])(ye,de,me,!1,null,null,null),ke=De.exports;le()(De,"components",{QDialog:ee["a"],QCard:te["a"],QToolbar:ne["a"],QToolbarTitle:ae["a"],QBtn:D["a"],QCardSection:se["a"],QTime:Ce["a"],QCardActions:ie["a"],QTab:_e["a"]}),le()(De,"directives",{ClosePopup:re["a"]});var Ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-splitter",{staticClass:"compParking",staticStyle:{height:"100%"},scopedSlots:e._u([{key:"before",fn:function(){return[n("q-tabs",{staticClass:"text-teal",attrs:{vertical:""},model:{value:e.tvue,callback:function(t){e.tvue=t},expression:"tvue"}},[n("q-tab",{attrs:{name:"formulaire",icon:"feed",label:"Formulaire"}}),n("q-tab",{attrs:{name:"donnees",icon:"list_alt",label:"Liste"}})],1)]},proxy:!0},{key:"after",fn:function(){return[n("q-tab-panels",{attrs:{animated:"",vertical:"","transition-prev":"jump-up","transition-next":"jump-up"},model:{value:e.tvue,callback:function(t){e.tvue=t},expression:"tvue"}},[n("q-tab-panel",{staticClass:"q-pt-none",attrs:{name:"formulaire"}},[n("div",{staticClass:"text-h5 text-center q-mb-md"},[e._v("\n          Formulaire pour un nouveau visiteur\n        ")]),n("f-vv-form",{attrs:{title:"parking"}})],1),n("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"donnees"}})],1)]},proxy:!0}]),model:{value:e.splitterModel,callback:function(t){e.splitterModel=t},expression:"splitterModel"}})},Se=[],Oe=Object(c["d"])({name:"FParking",components:{FVvForm:O["a"]},data:function(){return{tvue:"formulaire",splitterModel:20}},props:{title:{type:String,required:!1}},methods:{onRowClick:function(e){}}}),Re=Oe,je=(n("d864"),n("8562")),Fe=n("429b"),Pe=n("adad"),Te=n("823b"),Ee=Object(P["a"])(Re,Ae,Se,!1,null,null,null),Me=Ee.exports;le()(Ee,"components",{QSplitter:je["a"],QTabs:Fe["a"],QTab:_e["a"],QTabPanels:Pe["a"],QTabPanel:Te["a"]});var Ne=n("f9ea"),Qe=(d["a"].lighten,d["a"].setBrand,Object(c["d"])({components:{FAcceuilGrid:ue,FVvForm:O["a"],FAccueil:ke,FParking:Me},name:"PageAcceuil",data:function(){var e={days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_"),firstDayOfWeek:0};return{senderTo:"",subjectTo:"",messageTo:"",tabForm:"accueil",showAdminMenu:!1,showUserMenu:!1,showMailMessage:!1,datedujour:p["b"].formatDate(Date.now(),"DD/MM/YYYY"),myLocale:e,showParticules:!0,dvisiteurs:null}},computed:l()(l()(l()(l()({},Object(u["d"])("adinfos",{isAdmin:function(e){return e.isAdmin},isSiteAdmin:function(e){return e.isSiteAdmin},grpUser:function(e){return e.userGrpes},siteRole:function(e){return e.siteRole}})),Object(u["d"])("admin",{formData:function(e){return e.getform},fconfig:function(e){return e.config},visiteurs:function(e){return e.visiteurs}})),Object(u["d"])("auth",{currentUsername:function(e){return e.user.displayName}})),{},{displayName:function(){return this.currentUsername},othersMenu:function(){return this.plusMenu},showDev:function(){return!1},allowRegistre:function(){return!!this.grpUser&&this.grpUser.includes("Application WEB REGISTRE")},allowParking:function(){return!!this.grpUser&&this.grpUser.includes("WebApps - ADM PARKING")},regvisiteurs:function(){if(this.dvisiteurs&&Array.isArray(this.dvisiteurs))return this.visiteurs.filter((function(e){return"attente"!=e.etat&&"efface"!=e.etat&&"sortie"!=e.etat}))},totalVisiteurs:function(){var e=this;if(this.dvisiteurs&&Array.isArray(this.dvisiteurs))return this.regvisiteurs.filter((function(t){return t.datevisite==e.datedujour&&"attente"!=t.etat&&"efface"!=t.etat&&"sortie"!=t.etat})).length},totalRdcVisiteurs:function(){if(this.dvisiteurs&&Array.isArray(this.dvisiteurs))return this.regvisiteurs.filter((function(e){return"RDC"==e.typeacces&&"parking"!=e.etat})).length},totalParkingVisiteurs:function(){if(this.dvisiteurs&&Array.isArray(this.dvisiteurs))return console.log("Visiteurs  :",this.regvisiteurs.filter((function(e){return"PARKING"==e.typeacces}))),this.regvisiteurs.filter((function(e){return"PARKING"==e.typeacces})).length}}),methods:l()(l()(l()({},Object(u["b"])("adinfos",["getRole"])),Object(u["b"])("admin",["getAllVisiteurs","getAllUsers","addVisiteur","getForm","saveForm","getConfig","writeConfig","sendMail"])),{},{saveSendMail:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object.assign({},e.fconfig),n["mail"]=Object.assign({},{to:e.senderTo,subject:e.subjectTo,message:e.messageTo}),console.log("New config :",n),e.$q.loading.show({spinner:f["a"],spinnerColor:"blue",message:"Chargement en cours..."}),t.next=6,e.writeConfig(n);case 6:e.$q.loading.hide(),e.$q.dialog({message:"Paramettre de la messagerie sauvegardée!"});case 8:case"end":return t.stop()}}),t)})))()},saveDate:function(){console.log("Nouvelle date :",this.datedujour)},testSendMail:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("Message à envoyé :",e.messageTo),e.sendMail({to:e.senderTo,subject:e.subjectTo,message:e.messageTo}).then((function(){e.$q.dialog({message:"Message envoyé!"})}))["catch"]((function(){e.$q.dialog({message:"!! Message non envoyé!"})}));case 2:case"end":return t.stop()}}),t)})))()},openExtURL:function(e){Object(b["a"])(e,null)},showSettings:function(e){var t=this;this.$q.dialog({component:Ne["a"],config:this.fconfig,twidth:"70%"}).onOk(function(){var e=r()(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("OK settings",n),e.next=3,t.writeConfig(n);case 3:Object(n).hasOwnProperty("bgright")&&d["a"].setBrand("bgright",n.bgright);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))},changeDate:function(e,t,n){console.log("click date :",e),null==e&&(this.datedujour=p["b"].formatDate(Date.now(),"DD/MM/YYYY")),this.$root.$emit("changeDate",this.datedujour),this.$refs.ladatedujour.hide()},onRowClick:function(e,t){console.log("Ligne sélectionnée : ",e,t),t&&(this.selectedUser=t,"case à cocher"!=e&&(this.showUserInfos=!0),console.log("Table ref :",this.$refs.myTable))}}),beforeMount:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show({spinner:m["a"],spinnerColor:"red",message:"Chargement en cours..."}),t.next=3,e.$store.dispatch("adinfos/getRole",e.$store.state.auth.user);case 3:return t.next=5,e.getAllVisiteurs();case 5:e.$q.loading.hide(),e.dvisiteurs=Object.assign([],e.visiteurs),console.log("Les visiteurs :",e.dvisiteurs);case 8:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("Result auth:",e.$store.state.auth),console.log("Meta infos :",e.$route.query.type);case 2:case"end":return t.stop()}}),t)})))()}})),$e=Qe,Ie=(n("dd78"),n("9989")),Ve=n("d66b"),Je=n("6b1d"),Ye=Object(P["a"])($e,a,s,!1,null,null,null);t["default"]=Ye.exports;le()(Ye,"components",{QPage:Ie["a"],QIcon:V["a"],QSeparator:L["a"],QItem:G["a"],QItemSection:H["a"],QItemLabel:W["a"],QDialog:ee["a"],QCard:te["a"],QToolbar:ne["a"],QToolbarTitle:ae["a"],QBtn:D["a"],QCardSection:se["a"],QInput:I["a"],QEditor:Ve["a"],QLinearProgress:Je["a"],QList:K["a"],QTab:_e["a"]}),le()(Ye,"directives",{ClosePopup:re["a"]})},"31c3":function(e,t,n){"use strict";n("3996")},3996:function(e,t,n){},d864:function(e,t,n){"use strict";n("0697")},dd78:function(e,t,n){"use strict";n("18a3")}}]);
(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([[19],{"1ac4":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{staticClass:"flex flex-center"},[i("div",{class:e.$q.dark.isActive?"dark_gradient":"normal_gradient",attrs:{id:"particles-js"}}),e.showBuilder?i("q-form-builder",{attrs:{value:e.fields,nameForm:e.currentFormName},on:{save:e.onSave,goBack:function(t){return e.gotoAccueil()},onlist:e.showListForms}}):e._e(),e.showBuilder?e._e():i("q-card",{style:e.$q.platform.is.mobile||e.$q.screen.sm||e.$q.screen.xs?{width:"95%"}:{width:"75%"}},[e.isSiteAdmin?i("q-toolbar",{staticClass:"text-primary"},[i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"menu"},on:{click:function(t){e.showAdminMenu=!e.showAdminMenu}}}),i("q-toolbar-title",[e._v("\n                Paramètres Administrateur\n            ")]),i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"settings"},on:{click:e.showSettings}},[i("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Réglages divers...\n              ")])],1),i("q-btn",{attrs:{icon:"edit",flat:""},on:{click:function(t){e.showBuilder=!0}}},[i("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Modification du formulaire...\n              ")])],1)],1):e._e(),i("q-card-section",{staticClass:"row no-wrap justify-center items-center q-py-md  bg-primary text-white",attrs:{dense:""}},[i("div",{staticClass:"text-h6 full-width"},[e._v(e._s(e.currentTitle))]),i("q-btn",{attrs:{icon:"menu",flat:"",round:"",dense:""},on:{click:function(t){e.showUserMenu=!e.showUserMenu}}},[i("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Affiche le menu principal\n              ")])],1)],1),i("q-card-section",{staticClass:"q-gutter-md row"},[i("q-form",{ref:"myForm",style:e.$q.platform.is.mobile?{width:"95%"}:{width:"100%"},on:{submit:e.onSubmit}},[i("div",{staticClass:"q-gutter-none row"},e._l(e.fields,(function(t,a){return i("div",{key:a,class:t.span?"col-"+t.span:"col-auto"},[i(e.getElement(t),{ref:t.cid,refInFor:!0,tag:"component",attrs:{label:t.label,labelToolTip:t.labelToolTip,required:t.required,field_options:t.field_options,id:t.id,cid:t.cid,debounce:"500"},on:{input:e.onInput},model:{value:e.fieldData[t.id],callback:function(i){e.$set(e.fieldData,t.id,i)},expression:"fieldData[field.id]"}})],1)})),0)])],1),i("q-card-actions",{attrs:{align:"center"}},[i("q-btn",{attrs:{color:"negative","no-caps":"",icon:"list",label:"Liste des données",to:{path:"donnees",query:{type:e.currentFormName}}}},[i("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Liste des données du formulaire...\n              ")])],1),i("q-space"),i("q-btn",{staticClass:"q-pa-sm",attrs:{icon:"save",color:"primary","no-caps":"",label:"Ajouter"},on:{click:function(t){return e.$refs.myForm.submit()}}},[i("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Ajoute une donnée\n              ")])],1)],1),i("q-card-actions",{attrs:{align:"right"}})],1),i("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showAdminMenu,callback:function(t){e.showAdminMenu=t},expression:"showAdminMenu"}},[i("q-card",{staticStyle:{width:"280px"}},[i("q-linear-progress",{attrs:{value:1,color:"amber"}}),i("q-card-section",{staticClass:"row items-start no-wrap"},[i("q-list",[i("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n                        Menu Administrateur\n                    ")]),i("q-item",{attrs:{clickable:"",to:"/"}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"home"}})],1),i("q-item-section",[i("q-item-label",[e._v("Accueil")]),i("q-item-label",{attrs:{caption:""}},[e._v("\n                                Retour à l'accueil\n                            ")])],1)],1)],1)],1)],1)],1),i("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showUserMenu,callback:function(t){e.showUserMenu=t},expression:"showUserMenu"}},[i("q-card",{staticStyle:{width:"280px"}},[i("q-linear-progress",{attrs:{value:1,color:"amber"}}),i("q-card-section",{staticClass:"row items-start no-wrap"},[i("q-list",[i("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n                        Menu Utilisateur\n                    ")]),i("q-item",{attrs:{clickable:"",to:"/"}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"home"}})],1),i("q-item-section",[i("q-item-label",[e._v("Accueil")]),i("q-item-label",{attrs:{caption:""}},[e._v("\n                                Retour à l'accueil\n                            ")])],1)],1),i("q-item",{attrs:{clickable:"",to:{path:"nouveau",query:{type:"parking"}}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"directions_car_filled"}})],1),i("q-item-section",[i("q-item-label",[e._v("Packing")]),i("q-item-label",{attrs:{caption:""}},[e._v("\n                                Formulaire packing\n                            ")])],1)],1)],1)],1)],1)],1)],1)},s=[],r=(i("ddb0"),i("e9c4"),i("2f62")),o=i("ed09"),n=i("bc78"),l=i("cf57"),c=i("bd4c"),d=i("c18b"),m=(i("985a"),i("bc6f")),u=i("f9ea");const{lighten:h,setBrand:f}=n["a"];var p=Object(o["d"])({name:"PageNouveau",components:{QFormBuilder:d["q"],TextElement:d["w"],CacemusersElement:d["b"],ParagraphElement:d["m"],CheckboxesElement:d["c"],RadioElement:d["r"],DateElement:d["e"],TimeElement:d["x"],DropdownElement:d["f"],EmailElement:d["g"],NameElement:d["k"],SimpleNameElement:d["u"],AddressElement:d["a"],PhoneElement:d["p"],FileElement:d["h"],PaymentElement:d["o"],TermsElement:d["v"],PageBreakElement:d["l"],ImageElement:d["j"],SectionBreakElement:d["t"]},data(){"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_");return{tab:"nouveau",showBuilder:!1,fields:[],fieldData:[],fieldsModel:{},showPopUp:!1,showTimePopUp:!1,FormValid:!0,showAdminMenu:!1,showUserMenu:!1,showParticules:!0,currentTitle:"",selectedDate:c["b"].formatDate(Date.now(),"DD/MM/YYYY"),selectedTime:c["b"].formatDate(Date.now(),"HH:mm"),sfVisiteurs:{arriveed:c["b"].formatDate(Date.now(),"DD/MM/YYYY"),arriveeh:c["b"].formatDate(Date.now(),"HH:mm"),sortieh:c["b"].formatDate(Date.now(),"HH:mm")}}},computed:{...Object(r["e"])("adinfos",{isAdmin:e=>e.isAdmin,isSiteAdmin:e=>e.isSiteAdmin}),...Object(r["e"])("admin",{formData:e=>e.getform,fconfig:e=>e.config}),ffields(){return Object.assign([],this.fields)}},methods:{...Object(r["c"])("admin",["getAllVisiteurs","addVisiteur","getForm","saveForm","getConfig","writeConfig"]),async gotoAccueil(){this.currentFormName="accueil",await this.updateDisplayForm("accueil"),this.showBuilder=!1},onSubmit(e){console.log("Form submit :",this.$refs.myForm),this.$refs.myForm.validate().then((async e=>{console.log("Valid :",e),console.log("Form :",this.fieldData),await this.addVisiteur(this.fieldData),this.$q.notify({message:"Visiteur ajouté avec succès",color:"positive"}),console.log("Valeur des champs :",this.fieldData);for(const[t,i]of Object.entries(this.fieldData))this.fieldData[t]="";this.$refs.myForm.reset()})).catch((e=>{this.$q.notify({message:"Formulaire incomplet !!!",color:"negative"})}))},selVisiteur(e,t,i){console.log("Selection du visiteur :",t)},async onSave(e){if(console.log("onSave :",e),await this.saveForm({nom:e.formName,data:e.data}),await this.updateDisplayForm(this.currentFormName),this.formData.length>0&&this.formData[0].data.length>0){const e=Object.assign([],this.formData),t=Object.assign([],e[0].data);this.setForm(t,{})}this.$q.notify({message:"Visiteur ajouté avec succès",color:"positive"}),console.log("Donnees form :",this.fieldData)},saveDate(){console.log("Selected Date :",this.selectedDate),console.log("My form :",this.$refs.myForm),this.$refs.myForm.fieldInput({id:"arriveed",value:c["b"].formatDate(this.selectedDate,"DD/MM/YYYY")})},saveTime(){console.log("Selected Time :",this.selectedDate),console.log("My form :",this.$refs.myForm),this.$refs.myForm.fieldInput({id:"arriveeh",value:c["b"].formatDate(this.selectedTime,"HH:mm")})},showListForms(e){this.$q.dialog({component:m["a"],dbname:"formulaires",dbtype:"db_regvisiteurs",twidth:"70%"}).onOk((async e=>{console.log("OK",e),this.currentFormName=e.nom,await this.updateDisplayForm(this.currentFormName)})).onCancel((()=>{console.log("Cancel")})).onDismiss((()=>{console.log("Called on OK or Cancel")}))},showSettings(e){this.$q.dialog({component:u["a"],config:this.fconfig,twidth:"70%"}).onOk((async e=>{console.log("OK settings",e),await this.writeConfig(e),Object(e).hasOwnProperty("bgright")&&n["a"].setBrand("bgright",e.bgright)})).onCancel((()=>{console.log("Cancel")})).onDismiss((()=>{console.log("Called on OK or Cancel")}))},async setForm(e,t){let i=Object.keys(t);Object.entries(t);this.fieldData=i.reduce(((e,i)=>(e[i]=t[i],e)),{});const a=Object.assign([],e);this.fields=Object.assign([],a),this.fieldsModel=Object.assign({},t)},onInput(e,t){console.log(`${t}: `+JSON.stringify(e)),console.log("Field Datas :",this.fieldData)},getElement(e){const t=e.field_type.split("_");for(let i=0;i<t.length;i++)t[i]=t[i].charAt(0).toUpperCase()+t[i].slice(1);return t.join("")+"Element"},async updateDisplayForm(e){if(await this.getForm({nom:e}),console.log("Donnée du formulaire chargée :",this.formData),"accueil"==e&&(this.currentTitle="ACCUEIL: Saisie d'un nouveau visiteur "),"parking"==e&&(this.currentTitle="PARKING : Saisie d'un nouveau visiteur "),Object(this.formData[0]).hasOwnProperty("titre")&&(this.currentTitle=this.formData[0].titre),this.formData.length>0&&this.formData[0].data.length>0){const e=Object.assign([],this.formData),t=Object.assign([],e[0].data);this.setForm(t,{datearr:c["b"].formatDate(Date.now(),"DD/MM/YYYY")})}}},async beforeRouteUpdate(e,t,i){if(console.log("Form change :",e.query.type),this.currentFormName=e.query.type,console.log("Current form :",this.currentFormName),"accueil"==this.currentFormName&&(this.currentTitle="ACCUEIL: Saisie d'un nouveau visiteur "),"parking"==this.currentFormName&&(this.currentTitle="PARKING : Saisie d'un nouveau visiteur "),this.$q.loading.show({spinner:l["a"],spinnerColor:"red",message:"Chargement en cours..."}),await this.getForm({nom:this.currentFormName}),this.$q.loading.hide(),console.log("Donnée du formulaire  :",this.formData),Object(this.formData[0]).hasOwnProperty("titre")&&(this.currentTitle=this.formData[0].titre),this.formData.length>0&&this.formData[0].data.length>0){const e=Object.assign([],this.formData),t=Object.assign([],e[0].data);this.setForm(t,{})}else this.setForm([{id:"datearr",field_type:"date",field_options:{description:"",filled:!0},span:12,label:"Date ",required:!0},{id:"heurearr",field_type:"time",field_options:{description:"",filled:!0},span:12,label:"Heure d'arrivée ",required:!0},{id:"visiteur",field_type:"name",field_options:{description:"",filled:!0},span:12,label:"Visiteur ",required:!0},{id:"status",field_type:"text",field_options:{description:"",filled:!0},span:12,label:"Status ",required:!1},{id:"motif",field_type:"dropdown",field_options:{description:"",options:[{checked:!1,label:"simple visite"},{checked:!1,label:"Rdv prestataire"},{checked:!1,label:"Rdv bureau"}],filled:!0},span:12,label:"Motif de la visite ",required:!1}],{datearr:c["b"].formatDate(Date.now(),"DD/MM/YYYY")});i()},async beforeMount(){await this.getConfig(),Object(this.fconfig).hasOwnProperty("bgright")&&n["a"].setBrand("bgright",this.fconfig.bgright),console.log("Meta infos :",this.$route.query.type),this.$q.loading.show({spinner:l["a"],spinnerColor:"red",message:"Chargement en cours..."}),await this.getAllVisiteurs(),this.$q.loading.hide()},async mounted(){if(this.showParticules&&particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:5},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:3,random:!0,anim:{enable:!1,speed:20,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:6,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!1,mode:"grab"},onclick:{enable:!1,mode:"push"},resize:!0},modes:{grab:{distance:140,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!1}),this.currentFormName=this.$route.query.type,console.log("Current form :",this.currentFormName),"accueil"==this.currentFormName&&(this.currentTitle="ACCUEIL: Saisie d'un nouveau visiteur "),"parking"==this.currentFormName&&(this.currentTitle="PARKING : Saisie d'un nouveau visiteur "),this.$q.loading.show({spinner:l["a"],spinnerColor:"red",message:"Chargement en cours..."}),await this.getForm({nom:this.currentFormName}),console.log("Donnée du formulaire  :",this.formData),Object(this.formData[0]).hasOwnProperty("titre")&&(this.currentTitle=this.formData[0].titre),this.formData.length>0&&this.formData[0].data.length>0){const e=Object.assign([],this.formData),t=Object.assign([],e[0].data);this.setForm(t,{})}else this.setForm([{id:"datearr",field_type:"date",field_options:{description:"",filled:!0},span:12,label:"Date ",required:!0},{id:"heurearr",field_type:"time",field_options:{description:"",filled:!0},span:12,label:"Heure d'arrivée ",required:!0},{id:"visiteur",field_type:"name",field_options:{description:"",filled:!0},span:12,label:"Visiteur ",required:!0},{id:"status",field_type:"text",field_options:{description:"",filled:!0},span:12,label:"Status ",required:!1},{id:"motif",field_type:"dropdown",field_options:{description:"",options:[{checked:!1,label:"simple visite"},{checked:!1,label:"Rdv prestataire"},{checked:!1,label:"Rdv bureau"}],filled:!0},span:12,label:"Motif de la visite ",required:!1}],{datearr:c["b"].formatDate(Date.now(),"DD/MM/YYYY")});this.$q.loading.hide()},watch:{fields:{handler(e){console.log("FormData :",e)},deep:!0}}}),g=p,b=i("2877"),v=i("9989"),_=i("9c40"),q=i("0378"),D=i("f09f"),y=i("65c6"),w=i("6ac5"),F=i("05c0"),k=i("a370"),C=i("4b7e"),M=i("2c91"),O=i("24e8"),x=i("6b1d"),A=i("1c1c"),j=i("0170"),S=i("66e5"),$=i("4074"),E=i("0016"),T=i("eebe"),N=i.n(T),Y=Object(b["a"])(g,a,s,!1,null,null,null);t["default"]=Y.exports;N()(Y,"components",{QPage:v["a"],QBtn:_["a"],QForm:q["a"],QCard:D["a"],QToolbar:y["a"],QToolbarTitle:w["a"],QTooltip:F["a"],QCardSection:k["a"],QCardActions:C["a"],QSpace:M["a"],QDialog:O["a"],QLinearProgress:x["a"],QList:A["a"],QItemLabel:j["a"],QItem:S["a"],QItemSection:$["a"],QIcon:E["a"]})}}]);
(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([[29],{"5c7c":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"container row full-width",attrs:{padding:""}},[n("q-vv-grid",{staticClass:"full-width",attrs:{data:e.rdata,columns:e.newColumns,header_filter:!0}})],1)},l=[],s=n("448a"),a=n.n(s),i=n("ded3"),r=n.n(i),c=(n("4160"),n("d3b7"),n("159b"),n("b64b"),n("caad"),n("2532"),n("a434"),n("c975"),n("7db0"),n("e9c4"),n("cca6"),n("d81d"),n("c740"),n("a9e3"),n("e260"),n("6062"),n("3ca3"),n("ddb0"),n("13d5"),n("2f62")),d=(n("bd4c"),n("cf57"),n("9c40")),u=n("05c0"),p=n("985a"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("q-table",{class:e.classes,attrs:{id:e.uuid,data:e.getFilteredValuesData,columns:e.columns,"row-key":"name","visible-columns":e.visible_columns,pagination:e.pagination,separator:e.separator,dense:e.dense,dark:e.dark,flat:e.flat,bordered:e.bordered,square:e.square,selection:e.selection_prop,selected:e.selected_prop,filter:e.filter},on:{"update:selected":function(t){e.selected_prop=t}},scopedSlots:e._u([{key:"header",fn:function(t){return[n("q-tr",{attrs:{props:t}},["none"!=e.selection_prop?n("q-th",{attrs:{"auto-width":""}},[t.multipleSelect?n("q-checkbox",{attrs:{"indeterminate-value":"some"},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"props.selected"}}):e._e()],1):e._e(),e._l(t.cols,(function(o){return n("q-th",{key:o.name,attrs:{props:t,"auto-width":""},nativeOn:{hover:function(e){e.stopPropagation()}}},[n("div",{staticClass:"row inline"},[n("div",{staticClass:"column"},[n("p",[e._v(e._s(o.label))])]),n("div",{staticClass:"column"},[e.header_filter?n("q-btn",{staticClass:"q-ml-xs",attrs:{flat:"",dense:"",size:"sm",icon:"fa fa-filter"},on:{click:function(e){e.stopPropagation()}}},[e.column_options_selected[o.field].length>0?n("q-icon",{staticStyle:{"font-size":"7px"},attrs:{name:"fas fa-asterisk",color:"red"}}):e._e(),n("q-menu",[n("q-space"),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"float-right q-ma-sm bg-red text-white",attrs:{dense:"",round:"",size:"sm",flat:"",icon:"close"}}),n("div",{staticClass:"q-pa-sm q-mt-md"},[n("q-select",{staticStyle:{width:"150px !important"},attrs:{"map-options":"",multiple:"","emit-value":"",filled:"",options:e.column_options[o.field]},model:{value:e.column_options_selected[o.field],callback:function(t){e.$set(e.column_options_selected,o.field,t)},expression:"column_options_selected[col.field]"}})],1),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"float-right  q-mr-sm q-mb-sm text-capitalize",attrs:{color:"primary",size:"sm",label:"Clear"},on:{click:function(t){return e.$set(e.column_options_selected,o.field,[])}}})],1)],1):e._e()],1)])])}))],2),e.columns_filter?n("q-tr",{staticClass:"ignore-elements",attrs:{props:t}},["none"!=e.selection_prop?n("q-th",{attrs:{"auto-width":""}}):e._e(),e._l(t.cols,(function(t){return n("q-th",{key:t.name,staticStyle:{padding:"0px 0px 0px 0px"}},[t.hasOwnProperty("filter_type")&&"text"!=t.filter_type?e._e():n("q-input",{staticClass:"q-pl-xs q-pr-xs",attrs:{dense:"",color:"teal",filled:""},scopedSlots:e._u([e.filter_data[t.field]?{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"cancel"},on:{click:function(n){n.stopPropagation(),e.filter_data[t.field]=""}}})]},proxy:!0}:null],null,!0),model:{value:e.filter_data[t.field],callback:function(n){e.$set(e.filter_data,t.field,n)},expression:"filter_data[col.field]"}}),t.hasOwnProperty("filter_type")&&"select"==t.filter_type?n("q-select",{attrs:{"map-options":"",multiple:"","emit-value":"",filled:"",options:e.column_options[t.field],dense:""},scopedSlots:e._u([{key:"append",fn:function(){return[e.column_options_selected[t.field].length>0?n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(n){return n.stopPropagation(),e.$set(e.column_options_selected,t.field,[])}}}):e._e()]},proxy:!0}],null,!0),model:{value:e.column_options_selected[t.field],callback:function(n){e.$set(e.column_options_selected,t.field,n)},expression:"column_options_selected[col.field]"}}):e._e()],1)}))],2):e._e()]}},e.excel_download||e.csv_download||e.fullscreen||e.global_search?{key:"top-right",fn:function(t){return[e.global_search?n("q-input",{staticClass:"q-mr-md",attrs:{filled:"",borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}):e._e(),e.excel_download?n("q-btn",{staticClass:"bg-grey-2 q-mr-sm",attrs:{icon:"fas fa-file-excel","no-caps":""},on:{click:function(t){return e.exportTable("xlsx")}}}):e._e(),e.csv_download?n("q-btn",{staticClass:"bg-primary text-white ",attrs:{icon:"fas fa-file-csv","no-caps":""},on:{click:function(t){return e.exportTable("csv")}}}):e._e(),e.fullscreen?n("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}},[n("q-tooltip",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:e.$q.platform.is.mobile}},[e._v(e._s(t.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"))])],1):e._e()]}}:null,{key:"body",fn:function(t){return[e.hasDefaultSlot?e._e():n("q-tr",{attrs:{props:t}},["none"!=e.selection_prop?n("q-td",{attrs:{"auto-width":""}},[n("q-checkbox",{attrs:{color:"primary"},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"props.selected"}})],1):e._e(),e._l(t.cols,(function(o){return n("q-td",{key:o.name,attrs:{props:t}},[e._v("\n            "+e._s(t.row[o.field])+"\n          ")])}))],2),e.hasDefaultSlot?e._t("body",null,{row:t.row}):e._e()]}}],null,!0)})],1)},m=[],_=(n("a15b"),n("ac1f"),n("1276"),n("4de4"),n("d401"),n("25f0"),n("5319"),n("4ec9"),n("99af"),n("aa47")),b=n("1732"),h=n("a357");function g(e,t){var n=void 0!==t?t(e):e;return n=void 0===n||null===n?"":String(n),n=n.split('"').join('""'),'"'.concat(n,'"')}var v={name:"Grid",props:["data","columns","file_name","csv_download","excel_download","columns_filter","header_filter","draggable","classes","separator","dense","dark","flat","bordered","square","selection","selected","fullscreen","global_search","visible_columns","pagination"],data:function(){return{filter_data:{},uuid:"",column_options:{},column_options_selected:{},filter_flags:{},selection_prop:"",name:"",selected_prop:[],filter:""}},computed:{getFilteredData:function(){var e=this,t=this.columns.map((function(e){return e.field})),n=this.data.filter((function(n){var o="";for(o=0;o<t.length;o++)if(""!=e.filter_data[t[o]]&&t[o]in e.filter_data&&-1==n[t[o]].toString().toLowerCase().indexOf(e.filter_data[t[o]].toLowerCase()))return!1;return!0}));return n},getFilteredValuesData:function(){var e=this;this.column_options_selected=Object.assign({},this.column_options_selected);var t=this.getFilteredData.filter((function(t){var n="";for(n=0;n<e.columns.length;n++)if(0!=e.column_options_selected[e.columns[n].field].length&&-1==e.column_options_selected[e.columns[n].field].indexOf(t[e.columns[n].field].toString().toLowerCase()))return!1;return!0}));return t},hasDefaultSlot:function(){return this.$scopedSlots.hasOwnProperty("body")}},mounted:function(){this.Sorting()},watch:{selected_prop:function(){this.$emit("selected-val",this.selected_prop)}},created:function(){this.uuid=Object(b["a"])(),void 0===this.selection?this.selection_prop="none":this.selection_prop=this.selection,void 0===this.file_name?this.name="Download":this.name=this.file_name,void 0===this.selected?this.selected_prop=[]:this.selected_prop=this.selected;var e=this;e.column_options={},e.columns.filter((function(t){return e.column_options[t.field]=[],e.$set(e.column_options_selected,t.field,[]),e.filter_flags[t.field]=!1,t})),e.data.filter((function(t){e.columns.filter((function(n){e.column_options[n.field].push({label:t[n.field].toString(),value:t[n.field].toString().toLowerCase().replace(/_/g,"_")})}))})),e.columns.filter((function(t){e.column_options[t.field]=a()(new Map(e.column_options[t.field].map((function(e){return[e["value"],e]}))).values())}))},methods:{exportTable:function(e){var t=this,n=[this.columns.map((function(e){return g(e.label)}))].concat(this.data.map((function(e){return t.columns.map((function(t){return g("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format)})).join(",")}))).join("\r\n"),o=Object(h["a"])(this.file_name+"."+e,n,"text/"+e);!0!==o&&this.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},Sorting:function(){var e=document.getElementById(this.uuid),t=e.querySelector("table tbody"),n=this;_["a"].create(t,{disabled:!this.draggable,onEnd:function(e){var t=n.data[e.oldIndex];n.data[e.oldIndex]=n.data[e.newIndex],n.data[e.newIndex]=t},onMove:function(e,t){if("ignore-elements q-tr"==e.related.className)return!1}})}}},w=v,q=n("2877"),x=n("eaac"),y=n("bd08"),k=n("357e"),C=n("8f8e"),j=n("0016"),O=n("4e73"),S=n("2c91"),N=n("ddd8"),Q=n("27f9"),$=n("db86"),D=n("7f67"),I=n("eebe"),F=n.n(I),R=Object(q["a"])(w,f,m,!1,null,"12e53a6c",null),T=R.exports;F()(R,"components",{QTable:x["a"],QTr:y["a"],QTh:k["a"],QCheckbox:C["a"],QBtn:d["a"],QIcon:j["a"],QMenu:O["a"],QSpace:S["a"],QSelect:N["a"],QInput:Q["a"],QTooltip:u["a"],QTd:$["a"]}),F()(R,"directives",{ClosePopup:D["a"]});var P=n("5494"),M={components:{FVvTable:p["a"],QVvGrid:T},data:function(){return{rdata:[]}},methods:{objectsNotIn:function(e,t){var n=[];return Object.keys(e).forEach((function(e){Object.keys(t).includes(e)||n.push(e)})),n.splice(n.indexOf("_id"),1),n}},computed:r()(r()({},Object(c["d"])("adinfos",{isAdmin:function(e){return e.isAdmin},isSiteAdmin:function(e){return e.isSiteAdmin},grpUser:function(e){return e.userGrpes},siteRole:function(e){return e.siteRole}})),Object(c["c"])("auth",["isAuthenticated","user"])),beforeMount:function(){var e=this;console.log("initialisation base de donnée..."),P["c"].service("tables").find({query:{tableDb:"cacemdb",tableName:"imprimantes",query:JSON.stringify({query:{}})}}).then((function(t){console.log("Données du tableau :",t),e.rdata=Object.assign([],t);var n=Object.assign([],t),o=e.rdata.map((function(e){return"".concat(Object.keys(e).length)}));console.log("Count keys :",o);var l=Math.max.apply(Math,a()(o)),s=Math.min.apply(Math,a()(o));console.log("Nb max props :",l),console.log("Nb min props :",s);var i=o.findIndex((function(e){return Number(e)==Number(l)}));console.log("Nb maxCols props :",i);var r=Object.assign([],e.rdata);console.log("Data max :",r[i]);var c=o.findIndex((function(e){return Number(e)==Number(s)}));console.log("Data :",e.rdata);a()(new Set(o));console.log("Data min :",r[c]);var d=Object.assign(r[i],r[c]);console.log("Fusion Obj :",d);var u=Object.keys(d);console.log("Columns :",u),e.editRow=u.reduce((function(e,t){return e[t]="",e}),{});var p=[];n.forEach((function(t,n){if(p.push({orig:Object.keys(t).length,col:Object.keys(e.editRow).length,obbj:e.objectsNotIn(t,e.editRow)}),e.objectsNotIn(t,e.editRow).length>0){var o=e.objectsNotIn(t,e.editRow).reduce((function(e,t){return e[t]="",e}),{});e.editRow=Object.assign(e.editRow,o)}})),console.log("New edit row :",e.editRow),u=Object.keys(e.editRow),e.newColumns=u.map((function(e){return{name:e,align:"center",label:e,field:e,filter_type:"select",sortable:!0}}))}))}},E=M,z=n("9989"),A=Object(q["a"])(E,o,l,!1,null,null,null);t["default"]=A.exports;F()(A,"components",{QPage:z["a"]})}}]);
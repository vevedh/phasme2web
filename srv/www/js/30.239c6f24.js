(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([[30],{"1ac4":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"flex flex-center"},[r("div",{class:e.$q.dark.isActive?"dark_gradient":"normal_gradient",attrs:{id:"particles-js"}}),e.showBuilder?r("q-form-builder",{attrs:{value:e.fields,nameForm:e.currentFormName},on:{save:e.onSave,goBack:function(t){return e.gotoAccueil()},onlist:e.showListForms}}):e._e(),e.showBuilder?e._e():r("q-card",{style:e.$q.platform.is.mobile||e.$q.screen.sm||e.$q.screen.xs?{width:"95%"}:{width:"75%"}},[e.isSiteAdmin?r("q-toolbar",{staticClass:"text-primary"},[r("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"menu"},on:{click:function(t){e.showAdminMenu=!e.showAdminMenu}}}),r("q-toolbar-title",[e._v("\n                Paramètres Administrateur\n            ")]),r("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"settings"},on:{click:e.showSettings}},[r("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Réglages divers...\n              ")])],1),r("q-btn",{attrs:{icon:"edit",flat:""},on:{click:function(t){e.showBuilder=!0}}},[r("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Modification du formulaire...\n              ")])],1)],1):e._e(),r("q-card-section",{staticClass:"row no-wrap justify-center items-center q-py-md  bg-primary text-white",attrs:{dense:""}},[r("div",{staticClass:"text-h6 full-width"},[e._v(e._s(e.currentTitle))]),r("q-btn",{attrs:{icon:"menu",flat:"",round:"",dense:""},on:{click:function(t){e.showUserMenu=!e.showUserMenu}}},[r("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Affiche le menu principal\n              ")])],1)],1),r("q-card-section",{staticClass:"q-gutter-md row"},[r("q-form",{ref:"myForm",style:e.$q.platform.is.mobile?{width:"95%"}:{width:"100%"},on:{submit:e.onSubmit}},[r("div",{staticClass:"q-gutter-none row"},e._l(e.fields,(function(t,n){return r("div",{key:n,class:t.span?"col-"+t.span:"col-auto"},[r(e.getElement(t),{ref:t.cid,refInFor:!0,tag:"component",attrs:{label:t.label,labelToolTip:t.labelToolTip,required:t.required,field_options:t.field_options,id:t.id,cid:t.cid,debounce:"500"},on:{input:e.onInput},model:{value:e.fieldData[t.id],callback:function(r){e.$set(e.fieldData,t.id,r)},expression:"fieldData[field.id]"}})],1)})),0)])],1),r("q-card-actions",{attrs:{align:"center"}},[r("q-btn",{attrs:{color:"negative","no-caps":"",icon:"list",label:"Liste des données",to:{path:"donnees",query:{type:e.currentFormName}}}},[r("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Liste des données du formulaire...\n              ")])],1),r("q-space"),r("q-btn",{staticClass:"q-pa-sm",attrs:{icon:"save",color:"primary","no-caps":"",label:"Ajouter"},on:{click:function(t){return e.$refs.myForm.submit()}}},[r("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n              Ajoute une donnée\n              ")])],1)],1),r("q-card-actions",{attrs:{align:"right"}})],1),r("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showAdminMenu,callback:function(t){e.showAdminMenu=t},expression:"showAdminMenu"}},[r("q-card",{staticStyle:{width:"280px"}},[r("q-linear-progress",{attrs:{value:1,color:"amber"}}),r("q-card-section",{staticClass:"row items-start no-wrap"},[r("q-list",[r("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n                        Menu Administrateur\n                    ")]),r("q-item",{attrs:{clickable:"",to:"/"}},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"home"}})],1),r("q-item-section",[r("q-item-label",[e._v("Accueil")]),r("q-item-label",{attrs:{caption:""}},[e._v("\n                                Retour à l'accueil\n                            ")])],1)],1)],1)],1)],1)],1),r("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showUserMenu,callback:function(t){e.showUserMenu=t},expression:"showUserMenu"}},[r("q-card",{staticStyle:{width:"280px"}},[r("q-linear-progress",{attrs:{value:1,color:"amber"}}),r("q-card-section",{staticClass:"row items-start no-wrap"},[r("q-list",[r("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n                        Menu Utilisateur\n                    ")]),r("q-item",{attrs:{clickable:"",to:"/"}},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"home"}})],1),r("q-item-section",[r("q-item-label",[e._v("Accueil")]),r("q-item-label",{attrs:{caption:""}},[e._v("\n                                Retour à l'accueil\n                            ")])],1)],1),r("q-item",{attrs:{clickable:"",to:{path:"nouveau",query:{type:"parking"}}}},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"directions_car_filled"}})],1),r("q-item-section",[r("q-item-label",[e._v("Packing")]),r("q-item-label",{attrs:{caption:""}},[e._v("\n                                Formulaire packing\n                            ")])],1)],1)],1)],1)],1)],1)],1)},a=[],i=r("278c"),o=r.n(i),s=r("c973"),l=r.n(s),c=r("ded3"),u=r.n(c),d=(r("96cf"),r("ac1f"),r("1276"),r("cca6"),r("4fadc"),r("b64b"),r("13d5"),r("d3b7"),r("e9c4"),r("fb6a"),r("a15b"),r("2f62")),m=r("ed09"),f=r("bc78"),p=r("cf57"),g=r("bd4c"),h=r("c18b"),b=(r("985a"),r("bc6f")),v=r("f9ea"),w=(f["a"].lighten,f["a"].setBrand,Object(m["d"])({name:"PageNouveau",components:{QFormBuilder:h["q"],TextElement:h["w"],CacemusersElement:h["b"],ParagraphElement:h["m"],CheckboxesElement:h["c"],RadioElement:h["r"],DateElement:h["e"],TimeElement:h["x"],DropdownElement:h["f"],EmailElement:h["g"],NameElement:h["k"],SimpleNameElement:h["u"],AddressElement:h["a"],PhoneElement:h["p"],FileElement:h["h"],PaymentElement:h["o"],TermsElement:h["v"],PageBreakElement:h["l"],ImageElement:h["j"],SectionBreakElement:h["t"]},data:function(){"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_");return{tab:"nouveau",showBuilder:!1,fields:[],fieldData:[],fieldsModel:{},showPopUp:!1,showTimePopUp:!1,FormValid:!0,showAdminMenu:!1,showUserMenu:!1,showParticules:!0,currentTitle:"",selectedDate:g["b"].formatDate(Date.now(),"DD/MM/YYYY"),selectedTime:g["b"].formatDate(Date.now(),"HH:mm"),sfVisiteurs:{arriveed:g["b"].formatDate(Date.now(),"DD/MM/YYYY"),arriveeh:g["b"].formatDate(Date.now(),"HH:mm"),sortieh:g["b"].formatDate(Date.now(),"HH:mm")}}},computed:u()(u()(u()({},Object(d["d"])("adinfos",{isAdmin:function(e){return e.isAdmin},isSiteAdmin:function(e){return e.isSiteAdmin}})),Object(d["d"])("admin",{formData:function(e){return e.getform},fconfig:function(e){return e.config}})),{},{ffields:function(){return Object.assign([],this.fields)}}),methods:u()(u()({},Object(d["b"])("admin",["getAllVisiteurs","addVisiteur","getForm","saveForm","getConfig","writeConfig"])),{},{gotoAccueil:function(){var e=this;return l()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.currentFormName="accueil",t.next=3,e.updateDisplayForm("accueil");case 3:e.showBuilder=!1;case 4:case"end":return t.stop()}}),t)})))()},onSubmit:function(e){var t=this;console.log("Form submit :",this.$refs.myForm),this.$refs.myForm.validate().then(function(){var e=l()(regeneratorRuntime.mark((function e(r){var n,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("Valid :",r),console.log("Form :",t.fieldData),e.next=4,t.addVisiteur(t.fieldData);case 4:for(t.$q.notify({message:"Visiteur ajouté avec succès",color:"positive"}),console.log("Valeur des champs :",t.fieldData),n=0,a=Object.entries(t.fieldData);n<a.length;n++)i=o()(a[n],2),s=i[0],i[1],t.fieldData[s]="";t.$refs.myForm.reset();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())["catch"]((function(e){t.$q.notify({message:"Formulaire incomplet !!!",color:"negative"})}))},selVisiteur:function(e,t,r){console.log("Selection du visiteur :",t)},onSave:function(e){var t=this;return l()(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log("onSave :",e),r.next=3,t.saveForm({nom:e.formName,data:e.data});case 3:return r.next=5,t.updateDisplayForm(t.currentFormName);case 5:t.formData.length>0&&t.formData[0].data.length>0&&(n=Object.assign([],t.formData),a=Object.assign([],n[0].data),t.setForm(a,{})),t.$q.notify({message:"Visiteur ajouté avec succès",color:"positive"}),console.log("Donnees form :",t.fieldData);case 8:case"end":return r.stop()}}),r)})))()},saveDate:function(){console.log("Selected Date :",this.selectedDate),console.log("My form :",this.$refs.myForm),this.$refs.myForm.fieldInput({id:"arriveed",value:g["b"].formatDate(this.selectedDate,"DD/MM/YYYY")})},saveTime:function(){console.log("Selected Time :",this.selectedDate),console.log("My form :",this.$refs.myForm),this.$refs.myForm.fieldInput({id:"arriveeh",value:g["b"].formatDate(this.selectedTime,"HH:mm")})},showListForms:function(e){var t=this;this.$q.dialog({component:b["a"],dbname:"formulaires",dbtype:"db_regvisiteurs",twidth:"70%"}).onOk(function(){var e=l()(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("OK",r),t.currentFormName=r.nom,e.next=4,t.updateDisplayForm(t.currentFormName);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))},showSettings:function(e){var t=this;this.$q.dialog({component:v["a"],config:this.fconfig,twidth:"70%"}).onOk(function(){var e=l()(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("OK settings",r),e.next=3,t.writeConfig(r);case 3:Object(r).hasOwnProperty("bgright")&&f["a"].setBrand("bgright",r.bgright);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).onCancel((function(){console.log("Cancel")})).onDismiss((function(){console.log("Called on OK or Cancel")}))},setForm:function(e,t){var r=this;return l()(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=Object.keys(t),Object.entries(t),r.fieldData=a.reduce((function(e,r){return e[r]=t[r],e}),{}),i=Object.assign([],e),r.fields=Object.assign([],i),r.fieldsModel=Object.assign({},t);case 6:case"end":return n.stop()}}),n)})))()},onInput:function(e,t){console.log("".concat(t,": ")+JSON.stringify(e)),console.log("Field Datas :",this.fieldData)},getElement:function(e){for(var t=e.field_type.split("_"),r=0;r<t.length;r++)t[r]=t[r].charAt(0).toUpperCase()+t[r].slice(1);return t.join("")+"Element"},updateDisplayForm:function(e){var t=this;return l()(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.getForm({nom:e});case 2:console.log("Donnée du formulaire chargée :",t.formData),"accueil"==e&&(t.currentTitle="ACCUEIL: Saisie d'un nouveau visiteur "),"parking"==e&&(t.currentTitle="PARKING : Saisie d'un nouveau visiteur "),Object(t.formData[0]).hasOwnProperty("titre")&&(t.currentTitle=t.formData[0].titre),t.formData.length>0&&t.formData[0].data.length>0&&(n=Object.assign([],t.formData),a=Object.assign([],n[0].data),t.setForm(a,{datearr:g["b"].formatDate(Date.now(),"DD/MM/YYYY")}));case 7:case"end":return r.stop()}}),r)})))()}}),beforeRouteUpdate:function(e,t,r){var n=this;return l()(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("Form change :",e.query.type),n.currentFormName=e.query.type,console.log("Current form :",n.currentFormName),"accueil"==n.currentFormName&&(n.currentTitle="ACCUEIL: Saisie d'un nouveau visiteur "),"parking"==n.currentFormName&&(n.currentTitle="PARKING : Saisie d'un nouveau visiteur "),n.$q.loading.show({spinner:p["a"],spinnerColor:"red",message:"Chargement en cours..."}),t.next=8,n.getForm({nom:n.currentFormName});case 8:n.$q.loading.hide(),console.log("Donnée du formulaire  :",n.formData),Object(n.formData[0]).hasOwnProperty("titre")&&(n.currentTitle=n.formData[0].titre),n.formData.length>0&&n.formData[0].data.length>0?(a=Object.assign([],n.formData),i=Object.assign([],a[0].data),n.setForm(i,{})):n.setForm([{id:"datearr",field_type:"date",field_options:{description:"",filled:!0},span:12,label:"Date ",required:!0},{id:"heurearr",field_type:"time",field_options:{description:"",filled:!0},span:12,label:"Heure d'arrivée ",required:!0},{id:"visiteur",field_type:"name",field_options:{description:"",filled:!0},span:12,label:"Visiteur ",required:!0},{id:"status",field_type:"text",field_options:{description:"",filled:!0},span:12,label:"Status ",required:!1},{id:"motif",field_type:"dropdown",field_options:{description:"",options:[{checked:!1,label:"simple visite"},{checked:!1,label:"Rdv prestataire"},{checked:!1,label:"Rdv bureau"}],filled:!0},span:12,label:"Motif de la visite ",required:!1}],{datearr:g["b"].formatDate(Date.now(),"DD/MM/YYYY")}),r();case 13:case"end":return t.stop()}}),t)})))()},beforeMount:function(){var e=this;return l()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getConfig();case 2:return Object(e.fconfig).hasOwnProperty("bgright")&&f["a"].setBrand("bgright",e.fconfig.bgright),console.log("Meta infos :",e.$route.query.type),e.$q.loading.show({spinner:p["a"],spinnerColor:"red",message:"Chargement en cours..."}),t.next=7,e.getAllVisiteurs();case 7:e.$q.loading.hide();case 8:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return l()(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showParticules&&particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:5},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:3,random:!0,anim:{enable:!1,speed:20,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:6,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!1,mode:"grab"},onclick:{enable:!1,mode:"push"},resize:!0},modes:{grab:{distance:140,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!1}),e.currentFormName=e.$route.query.type,console.log("Current form :",e.currentFormName),"accueil"==e.currentFormName&&(e.currentTitle="ACCUEIL: Saisie d'un nouveau visiteur "),"parking"==e.currentFormName&&(e.currentTitle="PARKING : Saisie d'un nouveau visiteur "),e.$q.loading.show({spinner:p["a"],spinnerColor:"red",message:"Chargement en cours..."}),t.next=8,e.getForm({nom:e.currentFormName});case 8:console.log("Donnée du formulaire  :",e.formData),Object(e.formData[0]).hasOwnProperty("titre")&&(e.currentTitle=e.formData[0].titre),e.formData.length>0&&e.formData[0].data.length>0?(r=Object.assign([],e.formData),n=Object.assign([],r[0].data),e.setForm(n,{})):e.setForm([{id:"datearr",field_type:"date",field_options:{description:"",filled:!0},span:12,label:"Date ",required:!0},{id:"heurearr",field_type:"time",field_options:{description:"",filled:!0},span:12,label:"Heure d'arrivée ",required:!0},{id:"visiteur",field_type:"name",field_options:{description:"",filled:!0},span:12,label:"Visiteur ",required:!0},{id:"status",field_type:"text",field_options:{description:"",filled:!0},span:12,label:"Status ",required:!1},{id:"motif",field_type:"dropdown",field_options:{description:"",options:[{checked:!1,label:"simple visite"},{checked:!1,label:"Rdv prestataire"},{checked:!1,label:"Rdv bureau"}],filled:!0},span:12,label:"Motif de la visite ",required:!1}],{datearr:g["b"].formatDate(Date.now(),"DD/MM/YYYY")}),e.$q.loading.hide();case 12:case"end":return t.stop()}}),t)})))()},watch:{fields:{handler:function(e){console.log("FormData :",e)},deep:!0}}})),_=w,q=r("2877"),D=r("9989"),y=r("9c40"),x=r("0378"),F=r("f09f"),k=r("65c6"),C=r("6ac5"),M=r("05c0"),O=r("a370"),A=r("4b7e"),j=r("2c91"),S=r("24e8"),R=r("6b1d"),$=r("1c1c"),E=r("0170"),T=r("66e5"),N=r("4074"),Y=r("0016"),P=r("eebe"),Q=r.n(P),I=Object(q["a"])(_,n,a,!1,null,null,null);t["default"]=I.exports;Q()(I,"components",{QPage:D["a"],QBtn:y["a"],QForm:x["a"],QCard:F["a"],QToolbar:k["a"],QToolbarTitle:C["a"],QTooltip:M["a"],QCardSection:O["a"],QCardActions:A["a"],QSpace:j["a"],QDialog:S["a"],QLinearProgress:R["a"],QList:$["a"],QItemLabel:E["a"],QItem:T["a"],QItemSection:N["a"],QIcon:Y["a"]})}}]);
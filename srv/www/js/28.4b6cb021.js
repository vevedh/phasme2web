(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([[28],{4524:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"flex flex-top justify-center q-pa-md q-pt-xl"},[e.showNew?e._e():r("q-card",{staticStyle:{width:"80%"},attrs:{flat:""}},[r("q-card-section",{staticClass:"full-width text-center text-h4"},[e._v("\n      Liste de vos formulaires\n    ")]),r("q-card-actions",{attrs:{vertical:"",align:"right"}},[r("q-btn",{staticClass:"bg-primary text-white q-mr-md",attrs:{flat:"",label:"Nouveau",icon:"add"},on:{click:function(t){e.showNew=!0}}})],1),r("q-card-section",{staticStyle:{width:"100%"}},[Array.isArray(e.allForms)&&e.allForms.length>0?r("f-vv-table",{ref:"fftables",attrs:{columns_filter:!0,datas:e.allowForms,columns:["nom","uid","type"],"row-key":"name",selectable:e.formEditable,editable:!0,editEvent:!0},on:{"row-click":e.openForm,onEdit:e.editForm}}):e._e()],1)],1),e.showNew?r("q-card",{staticStyle:{width:"75%"},attrs:{flat:""}},[r("q-card-section",{staticClass:"full-width text-center text-h4"},[e._v("\n   Détails de votre nouveau formulaire\n   "),r("h5",[e._v(e._s(e.newUid))])]),r("q-card-actions",{attrs:{horizontal:"",align:"right"}},[r("q-btn",{staticClass:"bg-primary text-white q-mr-md",attrs:{flat:"",label:"Retour à la liste",icon:"arrow_back"},on:{click:function(t){e.showNew=!1}}}),r("q-btn",{staticClass:"bg-primary text-white q-mr-md",attrs:{flat:"",icon:"edit",to:"/formbuilder"}},[r("q-tooltip",{attrs:{"content-class":"bg-amber text-black","content-style":"font-size: 16px",anchor:"bottom middle"}},[e._v("\n          Modifier le formulaire...\n        ")])],1)],1),r("q-card-section",[r("f-vv-form",{staticClass:"q-pa-sm",attrs:{fieldsData:[{label:"Général",field_type:"section_break",cid:"8229dc9a-6787-4be5-8e3d-e9749d975ea9",name:"section_break",show_options:[],event_options:[],span:"12"},{label:"Nom du Formulaire",field_type:"text",required:!0,cid:"b2ddfcc8-3ff2-4d04-90cc-fb24920d78c9",id:"nom",span:12,show_options:[],field_options:{description:"",span:12,filled:!1,"stack-label":!0}}],showSave:!0},on:{onFormAdded:e.addNewForm}})],1)],1):e._e(),r("q-dialog",{attrs:{persistent:""},model:{value:e.showAlertFormName,callback:function(t){e.showAlertFormName=t},expression:"showAlertFormName"}},[r("q-card",[r("q-card-section",{staticClass:"row items-center"},[r("q-icon",{attrs:{size:"5vh",name:"info_outline",color:"negative"}}),r("span",{staticClass:"q-ml-sm"},[e._v("Ce nom de formulaire existe déjà !")])],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Fermer",color:"negative"}})],1)],1)],1)],1)},a=[],o=r("c973"),i=r.n(o),s=r("ded3"),l=r.n(s),c=(r("96cf"),r("4de4"),r("d3b7"),r("ed09")),d=r("2f62"),u=(r("bd4c"),r("cf57")),m=r("9c40"),f=r("05c0"),p=r("1732"),h=r("985a"),b=r("7596"),w=Object(c["d"])({name:"FormulairesPage",data:function(){return{allf:[],newFormUid:null,showNew:!1,showAlertFormName:!1}},components:{FVvTable:h["a"],FVvForm:b["a"]},computed:l()(l()(l()(l()(l()({},Object(d["d"])("auth",{currentUserId:function(e){return e.user.sAMAccountName}})),Object(d["d"])("adinfos",{isAdmin:function(e){return e.isAdmin},isSiteAdmin:function(e){return e.isSiteAdmin},grpUser:function(e){return e.userGrpes},siteRole:function(e){return e.siteRole}})),Object(d["d"])("auth",{currentUserId:function(e){return e.user.sAMAccountName}})),Object(d["d"])("admin",{allForms:function(e){return e.allForms}})),{},{allowForms:function(){var e=this;if(Array.isArray(this.allForms))return this.allForms.filter((function(t){return t.user==e.currentUserId||"publique"==t.type}))},formEditable:function(){return this.isAdmin},newUid:function(){return this.newFormUid=Object(p["a"])(),this.newFormUid}}),methods:l()(l()({},Object(d["b"])("admin",["getForm","saveForm","updateForm","getAllForms","getConfig","writeConfig"])),{},{openForm:function(e,t,r){this.$router.push("/form/".concat(t.uid))},editForm:function(e){console.log("Champs :",e),e._id&&this.$router.push("/formbuilder/".concat(e.uid))},addNewForm:function(e){var t=this;return i()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(0!==t.allForms.filter((function(t){return t.nom===e.nom})).length){r.next=12;break}return console.log("Valeurs du formulaire :",e),e.uid=t.newUid,e.type="privé",e.user=t.currentUserId,e.data=[],e.sendmails=["admindsi@cacem.fr"],e.templateid="",r.next=10,t.saveForm(e);case 10:r.next=13;break;case 12:t.showAlertFormName=!0;case 13:case"end":return r.stop()}}),r)})))()}}),beforeMount:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show({spinner:u["a"],spinnerColor:"red",message:"Chargement en cours..."}),t.next=3,e.getAllForms();case 3:e.$q.loading.hide(),console.log("Formulaires autorisés :",e.allForms);case 5:case"end":return t.stop()}}),t)})))()}}),F=w,g=r("2877"),v=r("9989"),q=r("f09f"),_=r("a370"),x=r("4b7e"),A=r("24e8"),C=r("0016"),y=r("7f67"),N=r("eebe"),k=r.n(N),U=Object(g["a"])(F,n,a,!1,null,null,null);t["default"]=U.exports;k()(U,"components",{QPage:v["a"],QCard:q["a"],QCardSection:_["a"],QCardActions:x["a"],QBtn:m["a"],QTooltip:f["a"],QDialog:A["a"],QIcon:C["a"]}),k()(U,"directives",{ClosePopup:y["a"]})}}]);
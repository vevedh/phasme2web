(this["webpackJsonp"]=this["webpackJsonp"]||[]).push([[5],{"0697":function(e,t,s){},"31c3":function(e,t,s){"use strict";s("3996")},3996:function(e,t,s){},"3d07":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{staticClass:"container q-px-lg vertical-top bg-light-blue-1"},[i("div",{staticClass:"column full-width items-end q-px-md"},[i("div",{staticClass:"q-px-sm text-h5"},[i("span",[i("q-icon",{attrs:{name:"time",size:"10px",color:"secondary"}}),e._v("\n        Le "+e._s(e.datedujour)+"\n      ")],1)])]),i("q-separator",{attrs:{color:"teal",size:"2px"}}),i("div",{staticClass:"row q-pa-md q-gutter-md"},[i("div",{staticClass:"col-12 col-md"},[i("q-card",{staticClass:"my-card text-white bg-blue"},[i("q-card-section",[i("div",{staticClass:"text-center text-bold bg-blue-9"},[e._v("Total Visiteurs Accueil")]),i("q-avatar",{attrs:{size:"100px","font-size":"52px","text-color":"white",icon:"support_agent"}}),i("q-knob",{staticClass:"text-white q-ma-md",attrs:{readonly:"","show-value":"",size:"90px",thickness:.22,color:"white","track-color":"white-3"},model:{value:e.totalRdcVisiteurs,callback:function(t){e.totalRdcVisiteurs=t},expression:"totalRdcVisiteurs"}})],1)],1)],1),i("div",{staticClass:"col-12 col-md"},[i("q-card",{staticClass:"my-card text-white bg-blue-3"},[i("q-card-section",[i("div",{staticClass:"text-center text-bold bg-blue-9"},[e._v("Total Visiteurs Parking")]),i("q-avatar",{attrs:{size:"100px","font-size":"52px","text-color":"white",icon:"directions_car_filled"}}),i("q-knob",{staticClass:"text-secondary q-ma-md",attrs:{readonly:"","show-value":"",size:"90px",thickness:.22,color:"secondary","track-color":"secondary-3"},model:{value:e.totalParkingVisiteurs,callback:function(t){e.totalParkingVisiteurs=t},expression:"totalParkingVisiteurs"}})],1)],1)],1),i("div",{staticClass:"col-12 col-md"},[i("q-card",{staticClass:"my-card text-white bg-blue-2 q-pa-none"},[i("q-card-section",[i("div",{staticClass:"text-center text-bold bg-blue-9"},[e._v(" Visiteurs à la CACEM le "+e._s(e.datedujour))]),i("q-avatar",{attrs:{size:"100px","font-size":"52px","text-color":"white",icon:"people"}}),i("q-knob",{staticClass:"text-yellow q-ma-md",attrs:{readonly:"","show-value":"",size:"90px",thickness:.22,color:"yellow","track-color":"yellow-5"},model:{value:e.totalVisiteurs,callback:function(t){e.totalVisiteurs=t},expression:"totalVisiteurs"}}),i("q-tooltip",{attrs:{"content-class":"bg-amber-4 text-dark text-bold text-h6 text-center"}},[e._v("\n              Le nombre de visiteurs à la CACEM le "+e._s(e.datedujour)+"\n            ")])],1)],1)],1)]),i("div",{staticClass:"col-12 col-md q-px-md"},[i("f-acceuil-table",{ref:"myTable",style:(e.$q.platform.is.mobile,{width:"100%"}),attrs:{titre:"Registre Visiteur ",dbname:"dbf_accueil",dbtype:"db_regvisiteurs",selectable:e.isSiteAdmin||e.isAdmin,editable:e.isSiteAdmin||e.isAdmin,useAdmin:e.isAdmin,hideexcel:!e.isAdmin},on:{"row-click":e.onRowClick}})],1),i("q-dialog",{model:{value:e.showMailMessage,callback:function(t){e.showMailMessage=t},expression:"showMailMessage"}},[i("q-card",{staticClass:"email-card",attrs:{bordered:""}},[i("q-toolbar",{staticClass:"full-width bg-primary"},[i("div",{staticClass:"q-pt-xs"},[i("img",{attrs:{src:s("056e")}})]),i("q-toolbar-title",{staticClass:"text-center text-white"},[i("q-icon",{staticClass:"q-px-md text-white",attrs:{name:"mail"}}),e._v("\n          Envoi d'un mail\n        ")],1),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close",color:"white"}})],1),i("q-card-section",[i("div",{staticClass:"row q-pa-xs"},[i("div",{staticClass:"col-12 q-pa-xs"},[i("q-input",{attrs:{label:"Envoyé vers :"},model:{value:e.senderTo,callback:function(t){e.senderTo=t},expression:"senderTo"}})],1),i("div",{staticClass:"col-12 q-pa-xs"},[i("q-input",{attrs:{label:"Objet :"},model:{value:e.subjectTo,callback:function(t){e.subjectTo=t},expression:"subjectTo"}})],1),i("div",{staticClass:"col-12"},[i("q-editor",{ref:"mailContent",attrs:{"min-height":"15rem"},model:{value:e.messageTo,callback:function(t){e.messageTo=t},expression:"messageTo"}})],1),i("div",{staticClass:"col-12 q-gutter-md q-py-md"},[i("q-btn",{attrs:{icon:"save",color:"primary","text-color":"white","no-caps":"",label:"Memoriser le message et le destinataire"},on:{click:function(t){return e.saveSendMail()}}}),i("q-btn",{attrs:{icon:"mail",color:"blue-3","text-color":"black",label:"Envoyé"},on:{click:function(t){return e.testSendMail()}}})],1)])])],1)],1),i("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showAdminMenu,callback:function(t){e.showAdminMenu=t},expression:"showAdminMenu"}},[i("q-card",{staticStyle:{width:"280px"}},[i("q-linear-progress",{attrs:{value:1,color:"amber"}}),i("q-card-section",{staticClass:"row items-start no-wrap"},[i("q-list",[i("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n            Menu Administrateur\n          ")]),i("q-item",{attrs:{clickable:"",to:"/"}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"home"}})],1),i("q-item-section",[i("q-item-label",[e._v("Accueil")]),i("q-item-label",{attrs:{caption:""}},[e._v("\n                Retour à l'accueil\n              ")])],1)],1)],1)],1)],1)],1),i("q-dialog",{attrs:{position:"left","full-height":""},model:{value:e.showUserMenu,callback:function(t){e.showUserMenu=t},expression:"showUserMenu"}},[i("q-card",{staticStyle:{width:"280px"}},[i("q-linear-progress",{attrs:{value:1,color:"amber"}}),i("q-card-section",{staticClass:"row items-start no-wrap"},[i("q-list",[i("q-item-label",{staticClass:"text-h6 text-grey-8 q-pt-xs",attrs:{header:""}},[e._v("\n            Menu Utilisateur\n          ")]),i("q-item",{attrs:{clickable:"",to:"/"}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"home"}})],1),i("q-item-section",[i("q-item-label",[e._v("Accueil")]),i("q-item-label",{attrs:{caption:""}},[e._v("\n                Retour à l'accueil\n              ")])],1)],1),i("q-item",{attrs:{clickable:""},on:{click:function(t){return e.openExtURL("http://svrsharepoint2/sites/DAG/DAAP/Documents%20partages/Forms/AllItems.aspx")}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"doc"}})],1),i("q-item-section",[i("q-item-label",[e._v("Documentation")]),i("q-item-label",{attrs:{caption:""}},[e._v("\n                Archives et Acceuil du public\n              ")])],1)],1)],1)],1)],1)],1)],1)},a=[],l=(s("e9c4"),s("ed09")),o=s("2f62"),n=s("bc78"),r=s("cf57"),c=s("163c"),d=s("bd4c"),u=s("b06b"),m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{},[e.show_ExcelImport?s("div",{staticClass:"row fit q-pb-md items-right justify-right full-width"},[s("q-uploader",{ref:"uploader",staticClass:"full-width q-px-none",attrs:{multiple:!1,"hide-upload-btn":!0,square:"",outlined:"",label:"Sélectionner un fichier excel",type:"file"},on:{added:e.onChange}}),e.currentFile.name?s("q-btn",{attrs:{color:"primary","text-color":"white",label:"Utiliser comme base de donnée"},on:{click:function(t){return e.saveToDatabase()}}}):e._e()],1):e._e(),s("q-table",{ref:"myTable",attrs:{id:"myTable",title:e.setTitle,data:e.datas?e.datas:e.liveDatas,"row-key":function(e){return e._id?e._id:e[Object.keys(e)[0]]},selection:e.useSelection,columns:e.newColumns,filter:e.filter,"no-data-label":"pas de données pour l'instant...","no-results-label":"Aucun résultat trouvé",selected:e.useSelected,"visible-columns":e.visibleColumns,pagination:e.initialPagination,separator:"cell"},on:{"row-click":e.rowSelect,"update:selected":function(t){e.useSelected=t}},scopedSlots:e._u([{key:"header",fn:function(t){return[s("q-tr",{attrs:{props:t}},[e.selectable||e.editable?s("q-th",{staticClass:"text-bold text-primary bg-blue-1"}):e._e(),e._l(t.cols,(function(i){return s("q-th",{key:i.name,staticClass:"text-bold text-primary bg-blue-1",attrs:{props:t}},[e.selectable||e.editable?s("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Filtre",icon:"filter_alt"}},[s("q-popup-edit",{ref:"filter_"+i.name,refInFor:!0,attrs:{cover:!1,offset:[0,2]},scopedSlots:e._u([{key:"default",fn:function(t){return[e.datesFields.includes(i.name)?s("div",{staticClass:"q-pa-none",staticStyle:{width:"180px"}},[s("div",{staticClass:"text-body2 text-grey q-mb-md"},[e._v("\n                    Critère de filtre ["+e._s(i.name)+"]\n                  ")]),s("div",{staticClass:"row items-center"},[s("div",{staticClass:"q-pa-none text-caption text-dark full-width"},[s("q-select",{attrs:{dense:"",filled:"",options:["annee","mois","jour"],label:"Date par"},model:{value:e.filtersParams[i.name].option,callback:function(t){e.$set(e.filtersParams[i.name],"option",t)},expression:"filtersParams[col.name].option"}})],1),s("div",{staticClass:"col-12 q-pa-none"},[s("q-input",{attrs:{dense:""},model:{value:e.filtersParams[i.name].value,callback:function(t){e.$set(e.filtersParams[i.name],"value",t)},expression:"filtersParams[col.name].value"}})],1),s("div",{staticClass:"q-pa-sm q-gutter-md"},[s("q-btn",{staticStyle:{"min-width":"68px"},attrs:{dense:"","no-caps":"",color:"primary",size:"sm",label:"Filtrer"},on:{click:function(s){return e.updateFilters(t,i.name)}}}),s("q-btn",{staticStyle:{"min-width":"68px"},attrs:{dense:"","no-caps":"",color:"grey-7",size:"sm",label:"Effacer"},on:{click:function(s){return e.deleteFilters(t,i.name)}}})],1)])]):e._e()]}}],null,!0),model:{value:e.filtersParams[i.name],callback:function(t){e.$set(e.filtersParams,i.name,t)},expression:"filtersParams[col.name]"}})],1):e._e(),e._v(e._s(String(i.label).toUpperCase())+"\n          ")],1)}))],2)]}},{key:"body-cell",fn:function(t){return[s("q-td",{staticClass:"q-pa-none",attrs:{props:t}},[e.ifJSON(t.value)?s("json-viewer",{attrs:{value:t.value}}):s("div",{staticClass:"q-pa-none inline cursor-pointer"},[s("div",{staticClass:"\n                q-pa-none\n                fit\n                flex flex-center\n                text-center\n                non-selectable\n                q-pa-md\n              "},[e._v("\n              "+e._s(t.value)+"\n            ")])])],1)]}},{key:"top-left",fn:function(t){return[s("div",{staticClass:"text-h6"},[e._v(e._s(""!=e.currentAcces?e.setTitle+" ["+e.currentAcces+"]":""+e.setTitle))]),s("div",{staticClass:"row q-gutter-sm q-py-md"},[e.useAdmin&&!e.hideexcel?s("q-btn",{staticClass:"q-px-sm",attrs:{color:"primary",dense:"","no-caps":""},on:{click:function(t){e.show_ExcelImport=!0}}},[s("q-icon",{attrs:{size:"0.9em",name:"far fa-file-excel"}}),s("q-icon",{attrs:{size:"0.9em",name:"fas fa-arrow-right"}}),s("q-icon",{attrs:{size:"0.9em",name:"fas fa-database"}}),s("div",{staticClass:"q-px-sm"},[e._v("Excel Init")])],1):e._e(),0!=e.newColumns.length&&e.showAdd?s("q-btn",{staticClass:"q-px-sm",attrs:{color:"primary",dense:"","no-caps":""},on:{click:function(t){e.show_AddDialog=!0}}},[e._v("Ajouter")]):e._e(),s("q-dialog",{model:{value:e.show_AddDialog,callback:function(t){e.show_AddDialog=t},expression:"show_AddDialog"}},[s("q-card",[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v("Ajouter un element!")])]),s("q-card-section",[s("div",{staticClass:"row"},e._l(e.newColumns,(function(t,i){return s("div",{key:"key-"+i,staticClass:"col-12"},[s("q-input",{attrs:{label:t.name},model:{value:e.editRow[""+t.name],callback:function(s){e.$set(e.editRow,""+t.name,s)},expression:"editRow[`${item.name}`]"}})],1)})),0)]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"},on:{click:function(t){e.show_AddDialog=!1}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.addRow}})],1)],1)],1)],1),s("div",{staticClass:"row q-gutter-md q-pb-md"},[s("q-btn",{staticClass:"q-px-md text-subtitle2 text-bold text-primary",attrs:{dense:"","no-caps":"",outline:""}},[e._v("\n            Les visites entre le\n            "+e._s(Object(e.dateRange).hasOwnProperty("from")?e.dateRange.from:null)+"\n            et le\n            "+e._s(Object(e.dateRange).hasOwnProperty("to")?e.dateRange.to:null)+"\n            "),s("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("q-date",{attrs:{locale:e.myLocale,mask:"DD/MM/YYYY",range:"",minimal:""},on:{"range-end":function(t){return e.filterRangeDate(e.dateRange)}},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}},[s("div",{staticClass:"row items-center justify-end"},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Fermer",color:"primary",flat:""}})],1)])],1),s("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n              Cliquez-ici pour voir les visites entre 2 dates\n            ")])],1),s("q-btn",{staticClass:"q-px-md text-subtitle2 text-bold text-primary",attrs:{dense:"","no-caps":"",outline:"",label:"Visites pour la date (cliquez-ici)"}},[s("q-popup-proxy",{ref:"btnDatej",attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("q-date",{attrs:{locale:e.myLocale,mask:"DD/MM/YYYY",minimal:""},on:{input:function(t){e.filterDateVisite(e.dateSelected),e.$refs.btnDatej.hide()}},model:{value:e.dateSelected,callback:function(t){e.dateSelected=t},expression:"dateSelected"}})],1),s("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n              Cliquez-ici pour voir les visites pour une date précise\n            ")])],1),s("q-btn",{attrs:{dense:"",color:"primary","no-caps":"",label:"Effacer les filtres"},on:{click:function(t){e.currentAcces="",e.customFilter=""}}},[s("q-tooltip",{attrs:{"content-class":"text-dark text-subtitle2 text-center bg-amber"}},[e._v("\n              Cliquez-ici pour effacer les filtres\n            ")])],1)],1),s("div",{staticClass:"row q-gutter-md q-pb-md"},[s("q-btn-dropdown",{attrs:{dense:"",color:"primary",label:"Lieu"}},e._l(e.lieuAcces,(function(t){return s("q-list",{key:"lieu-"+t},[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(s){return e.filterTypeAcces(t)}}},[s("q-item-section",[s("q-item-label",[e._v(e._s(t))])],1)],1)],1)})),1)],1),e.hideexcel?e._e():s("div",{staticClass:"row q-gutter-md q-pb-md"},[s("q-btn",{staticClass:"bg-primary",attrs:{dense:"",flat:"","no-caps":"","text-color":"white",icon:"far fa-file-excel",label:".xlsx"},on:{click:function(t){return e.exportDatasExcel()}}}),s("q-btn",{staticClass:"bg-primary",attrs:{dense:"","no-caps":"",flat:"","text-color":"white",icon:"fas fa-file-csv",label:".csv"},on:{click:function(t){return e.exportCsvTable()}}}),s("q-btn",{staticClass:"bg-primary",attrs:{dense:"","no-caps":"",flat:"",filled:"","text-color":"white",icon:"far fa-file-pdf",label:".pdf"},on:{click:function(t){return e.exportDatasPdf()}}})],1)]}},{key:"top-right",fn:function(t){return[s("div",{staticClass:"row q-gutter-sm"},[s("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Recherche","label-color":"text-dark"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1),s("q-select",{staticStyle:{"min-width":"150px"},attrs:{multiple:"",outlined:"",dense:"","options-dense":"","display-value":e.$q.lang.table.columns,"emit-value":"","map-options":"",options:e.newColumns,"option-value":"name","options-cover":""},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}}),s("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}})],1)]}},e.selected&&e.selected.length>0?{key:"bottom-row",fn:function(){return[s("q-tr",[s("q-td",{staticClass:"q-pa-md",attrs:{colspan:"100%"}},[e.selected&&e.selected.length>0&&e.editable?s("q-btn",{staticClass:"q-px-md q-mx-sm",attrs:{color:"red",dense:"","no-caps":""},on:{click:e.supPrevBtn}},[e._v("Supprimer")]):e._e(),e.selected&&e.selected.length>0&&e.editable?s("q-btn",{staticClass:"q-px-md q-mx-sm",attrs:{color:"grey-8",dense:"","no-caps":""},on:{click:function(t){e.show_EditDialog=!0}}},[e._v("Modifier")]):e._e(),s("q-dialog",{model:{value:e.show_EditDialog,callback:function(t){e.show_EditDialog=t},expression:"show_EditDialog"}},[s("q-card",{staticStyle:{width:"80%","max-width":"100%"}},[s("q-toolbar",{staticClass:"text-white  full-width bg-blue"},[s("q-toolbar-title",{staticClass:"text-h5"},[e._v(" Modification ! ")]),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),s("q-card-section",{staticClass:"q-pa-md",staticStyle:{width:"100%","max-width":"100%"}},[s("f-vv-form",{ref:"editForm",staticClass:"q-pa-sm",attrs:{title:""+e.dbname.split("dbf_")[1],fieldsmodel:e.selectedRow}})],1),s("q-card-actions",{staticClass:"q-px-xl q-py-md",attrs:{align:"center"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"},on:{click:function(t){e.show_EditDialog=!1}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.updateRow}})],1)],1)],1)],1)],1)]},proxy:!0}:null],null,!0)})],1)},h=[],p=(s("ddb0"),s("498a"),s("5319"),s("1146")),b=s("8baf"),f=(s("0da4"),s("5494")),g=s("a357"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-gutter-md row"},[s("q-form",{ref:"myForm",style:e.$q.platform.is.mobile?{width:"95%"}:{width:"100%"},on:{submit:e.onSubmit}},[s("div",{staticClass:"q-gutter-none row"},e._l(e.fields,(function(t,i){return s("div",{key:i,class:t.span?"col-"+t.span:"col-auto"},[e.setShow[t.id]?s(e.getElement(t),{ref:t.cid,refInFor:!0,tag:"component",attrs:{label:t.label,labelToolTip:t.labelToolTip,required:t.required,field_options:t.field_options,id:t.id,cid:t.cid,debounce:"500"},on:{input:e.onInput},model:{value:e.fieldData[t.id],callback:function(s){e.$set(e.fieldData,t.id,s)},expression:"fieldData[field.id]"}}):e._e()],1)})),0),s("div",{staticClass:"row q-gutter-xl item-center justify-center"},[e.fieldsmodel?e._e():s("q-btn",{staticClass:"q-pa-sm",attrs:{icon:"save",color:"primary","no-caps":"",label:"Enregistrer",type:"submit"}},[s("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n          Enregistrer\n        ")])],1),e.fieldsmodel?e._e():s("q-btn",{staticClass:"q-pa-sm",attrs:{icon:"mail",color:"primary","no-caps":"",label:"Notifier",type:"submit"}},[s("q-tooltip",{attrs:{"content-class":"bg-amber text-center text-h6 text-dark"}},[e._v("\n          Notifier par mail\n        ")])],1)],1)])],1)},w=[],y=s("9c40"),_=s("05c0"),q=s("c18b"),C=Object(l["d"])({name:"FVvForm",components:{QBtn:y["a"],QTooltip:_["a"],QFormBuilder:q["p"],TextElement:q["v"],CacemusersElement:q["b"],CommunesElement:q["d"],ParagraphElement:q["l"],CheckboxesElement:q["c"],RadioElement:q["q"],DateElement:q["e"],TimeElement:q["w"],DropdownElement:q["f"],EmailElement:q["g"],NameElement:q["j"],SimpleNameElement:q["t"],AddressElement:q["a"],PhoneElement:q["o"],FileElement:q["h"],PaymentElement:q["n"],TermsElement:q["u"],PageBreakElement:q["k"],ImageElement:q["i"],SectionBreakElement:q["s"],PassagersElement:q["m"]},props:{title:{type:String,required:!1},fieldsmodel:{type:Object,required:!1},hiddenFields:{required:!1,type:Array}},data(){"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_");return{fields:[],setShow:[],fieldData:[],FormValid:!0,selectedDate:d["b"].formatDate(Date.now(),"DD/MM/YYYY"),selectedTime:d["b"].formatDate(Date.now(),"HH:mm")}},computed:{...Object(o["e"])("adinfos",{isAdmin:e=>e.isAdmin,isSiteAdmin:e=>e.isSiteAdmin}),...Object(o["e"])("admin",{formData:e=>e.getform,fconfig:e=>e.config})},methods:{...Object(o["c"])("admin",["getAllVisiteurs","addVisiteur","getForm","saveForm","getConfig","writeConfig"]),onSubmit(e){console.log("Form submit :",this.$refs.myForm),this.$refs.myForm.validate().then((async e=>{console.log("Valid :",e),console.log("Form :",this.fieldData),await this.addVisiteur(this.fieldData),this.$q.notify({message:"Visiteur ajouté avec succès",color:"positive"}),console.log("Valeur des champs :",this.fieldData);for(const[t,s]of Object.entries(this.fieldData))this.fieldData[t]="";this.$refs.myForm.reset()})).catch((e=>{this.$q.notify({message:"Formulaire incomplet !!!",color:"negative"})}))},async setForm(e,t){let s=Object.keys(t);Object.entries(t);this.fieldData=s.reduce(((e,s)=>(e[s]=t[s],e)),{});const i=Object.assign([],e);this.fields=Object.assign([],i),this.fieldsModel=Object.assign({},t);let a=this.fields.map((e=>`${e.id}`));this.setShow=a.reduce(((e,t)=>(e[t]=!0,e)),{}),console.log("Show fields :",this.setShow),this.initConds(),this.hiddenFields&&this.fields.push(this.hiddenFields),this.fields.forEach(((e,t)=>{Object(e).hasOwnProperty("show_options")&&Array.isArray(e.show_options)&&e.show_options.length>0&&e.show_options.forEach((t=>{console.log("Champ cible:",e.id);let s=t.id_field;console.log("Champ source :",s);let i=t.valcalc;console.log("Champ source valeur de comparaison :",i),Object(this.fieldData).hasOwnProperty(`${s}`)&&(console.log(" Champ source réel :",this.fieldData[`${s}`]),this.setShow[`${e.id}`]=this.fieldData[`${s}`]==i)}))})),console.log("SET SHOW :",this.setShow)},initConds(){this.fields.forEach(((e,t)=>{Object(e).hasOwnProperty("show_options")&&Array.isArray(e.show_options)&&e.show_options.length>0&&(this.setShow[`${e.id}`]=!1)}))},onInput(e,t){console.log(`${t}: `+JSON.stringify(e)),console.log("Field Datas :",this.fieldData),this.fields.forEach(((e,t)=>{Object(e).hasOwnProperty("show_options")&&Array.isArray(e.show_options)&&e.show_options.length>0&&e.show_options.forEach((t=>{console.log("Champ cible:",e.id);let s=t.id_field;console.log("Champ source :",s);let i=t.valcalc;console.log("Champ source valeur de comparaison :",i),Object(this.fieldData).hasOwnProperty(`${s}`)&&(console.log(" Champ source réel :",this.fieldData[`${s}`]),this.setShow[`${e.id}`]=this.fieldData[`${s}`]==i)}))})),console.log("SET SHOW :",this.setShow)},getElement(e){const t=e.field_type.split("_");for(let s=0;s<t.length;s++)t[s]=t[s].charAt(0).toUpperCase()+t[s].slice(1);return t.join("")+"Element"},async updateDisplayForm(e){if(await this.getForm({nom:e}),console.log("Donnée du formulaire chargée :",this.formData),"accueil"==e&&(this.currentTitle="ACCUEIL: Saisie d'un nouveau visiteur "),"parking"==e&&(this.currentTitle="PARKING : Saisie d'un nouveau visiteur "),Object(this.formData[0]).hasOwnProperty("titre")&&(this.currentTitle=this.formData[0].titre),this.formData.length>0&&this.formData[0].data.length>0){const e=Object.assign([],this.formData),t=Object.assign([],e[0].data);this.fieldsmodel?this.setForm(t,this.fieldsmodel):this.setForm(t,this.fieldsModel?this.fieldsModel:{})}}},async mounted(){if(this.$q.loading.show({spinner:r["a"],spinnerColor:"red",message:"Chargement en cours..."}),await this.getForm({nom:this.title}),console.log("Donnée du formulaire  :",this.formData),Object(this.formData[0]).hasOwnProperty("titre")&&(this.currentTitle=this.formData[0].titre),this.formData.length>0&&this.formData[0].data.length>0){const e=Object.assign([],this.formData),t=Object.assign([],e[0].data);this.fieldsmodel?this.setForm(t,this.fieldsmodel):this.setForm(t,{})}else this.setForm([{id:"datearr",field_type:"date",field_options:{description:"",filled:!0},span:12,label:"Date ",required:!0},{id:"heurearr",field_type:"time",field_options:{description:"",filled:!0},span:12,label:"Heure d'arrivée ",required:!0},{id:"visiteur",field_type:"name",field_options:{description:"",filled:!0},span:12,label:"Visiteur ",required:!0},{id:"status",field_type:"text",field_options:{description:"",filled:!0},span:12,label:"Status ",required:!1},{id:"motif",field_type:"dropdown",field_options:{description:"",options:[{checked:!1,label:"Simple visite"},{checked:!1,label:"Rdv prestataire"},{checked:!1,label:"Rdv bureau"}],filled:!0},span:12,label:"Motif de la visite ",required:!1},{id:"chargeacceuil",field_type:"hidden",required:!1}],{datearr:d["b"].formatDate(Date.now(),"DD/MM/YYYY")});this.$q.loading.hide()},watch:{fields:{handler(e){console.log("FormData :",e)},deep:!0}}}),x=C,D=s("2877"),k=s("0378"),A=s("2c91"),O=s("eebe"),S=s.n(O),j=Object(D["a"])(x,v,w,!1,null,null,null),F=j.exports;S()(j,"components",{QForm:k["a"],QBtn:y["a"],QTooltip:_["a"],QSpace:A["a"]});var E=Object(l["d"])({components:{FVvForm:F},name:"FAcceuilTable",data(){const e={days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_"),firstDayOfWeek:0};return{myLocale:e,dateSelected:"",currentAcces:"",lieuAcces:[],data:[],currentFile:{},show_ExcelImport:!1,initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:5},visibleColumns:[],show_AddDialog:!1,show_EditDialog:!1,newColumns:[],editRow:{},selected:[],selectedRow:{},dateRange:{},filter:"",filters:{},filtersParams:{},filtersOperator:{},datesFields:[],customFilter:null}},props:{dbname:{type:String,required:!1},dbtype:{type:String,default:"mongodb",required:!1},datas:{type:Array,required:!1},columns:{type:Array,required:!1},labelsColumns:{type:Array,default:null,required:!1},editable:{type:Boolean,default:!0,required:!1},hideid:{type:Boolean,default:!0,required:!1},hideexcel:{type:Boolean,default:!0,required:!1},titre:{type:String,default:"",required:!1},useAdmin:{type:Boolean,default:!1,required:!1},selectable:{type:Boolean,default:!1,required:!1},showAdd:{type:Boolean,default:!1,required:!1}},computed:{setTitle(){return""==this.titre?this.dbname:this.titre},liveDatas(){return this.dbtype||this.dbname?Array.isArray(this.customFilter)?this.customFilter:[...this.data]:[...this.datas]},useSelection(){return this.editable||this.selectable?"single":"none"},useSelected:{get(){return this.editable||this.selectable?this.selected:[]},set(e){this.selected=e}}},methods:{filterArray(e,t){const s=Object.keys(t);return e.filter((e=>s.every((s=>"function"!==typeof t[s]||t[s](e[s])))))},ifJSON(e){try{return!("[object Object]"!==Object.prototype.toString.call(e)&&!Array.isArray(e))}catch(error){return!1}},onChange(e){let t=e?e[0]:null;console.log("File :",t),this.currentFile=t;const s=t;console.log("Files data :",s);const i=new FileReader;i.onload=e=>{const t=e.target.result,s=p["read"](t,{type:"binary",cellDates:!0}),i=s.SheetNames[0],a=s.Sheets[i];this.data&&(this.data=p["utils"].sheet_to_json(a,{header:0,raw:!0})),console.log("Datas :",this.data);let l=p["utils"].sheet_to_json(a,{header:1,raw:!0});if(console.log("Datas headers :",l),console.log("Datas with header :",l.length),Array.isArray(l)&&l.length>0){this.newColumns=[],console.log("Keys headers :",JSON.parse(JSON.stringify(l[0])));let e=JSON.parse(JSON.stringify(l[0])),t=e.map((e=>`${String(e).trim()}`));console.log("Keys headers :",t),this.visibleColumns=t,e.forEach((e=>{"string"==typeof e&&this.newColumns.push({name:e,field:e,label:e,sortable:!0})}))}},i.readAsBinaryString(t)},async saveToDatabase(){let e=Object.assign([],this.data),t=[];if(this.data=Object.assign([],t),Array.isArray(e)){if(e.forEach((async e=>{await f["c"].service("tables").create(JSON.parse(JSON.stringify(e)),{query:{tableDb:this.dbtype,tableName:this.dbname}})})),e.length>0){const t=Object.keys(e[0]);console.log("Columns :",t),this.editRow=t.reduce(((e,t)=>(e[t]="",e)),{}),this.newColumns=t.map((e=>({name:e,align:"center",label:e,field:e,sortable:!0})))}this.visibleColumns=Object.assign([],this.newColumns),this.hideid&&(this.visibleColumns=Object.assign([],this.visibleColumns.filter((e=>"_id"!=e.field)).map((e=>`${e.field.trim()}`))),console.log("Visible columns :",this.visibleColumns)),setTimeout((async()=>{await this.updateDatas(),this.show_ExcelImport=!1}),1e3)}},exportDatasExcel(){Promise.resolve().then(s.t.bind(null,"1146",7)).then((e=>{let t,s,i;if(i=this.data,this.newColumns.length>0){const e=[];i.forEach(((t,s,i)=>{let a={};this.newColumns.forEach(((e,s,i)=>{a[e.name]=t[e.field]})),console.log("données exportables:",a),e.push(a)})),t=this.newColumns,s=e}else{let e=[];this.newColumns.forEach((t=>{let s={title:t.name,dataKey:t.field};"Actions"!=t.name&&e.push(s)})),console.log("Columns :",e),t=e;const a=[];i.forEach(((e,t,s)=>{let i={};this.newColumns.forEach(((t,s,a)=>{i[t.name]=e[t.field]})),console.log("données exportables:",i),a.push(i)})),s=a}s.map((e=>(delete e._id,e)));let a=[t.filter((e=>"_id"!=e.name)).map((e=>e.name))];const l=p["utils"].book_new();e.utils.sheet_add_aoa(l,a);const o=e.utils.sheet_add_json(l,s,{origin:"A2",skipHeader:!0}),n={Sheets:{data:o},SheetNames:["data"]},r=e.write(n,{bookType:"xlsx",type:"array"}),c=Object(g["a"])("table-export.xlsx",r,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8");!0!==c&&this.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}))},exportDatasPdf(){Promise.resolve().then(s.t.bind(null,"0da4",7)).then((e=>{const t=new b["jsPDF"];let s,i;if(this.newColumns.length>0){const e=[];this.data.forEach(((t,s,i)=>{let a=[];this.newColumns.forEach(((e,s,i)=>{"_id"!=e.field&&a.push(t[e.field])})),console.log("données exportables:",a),e.push(a)}));let t=Object.assign([],this.newColumns);delete t._id,s=[t.filter((e=>"_id"!=e.name)).map((e=>e.name))],i=e}console.log("Columns :",s),console.log("Body :",i),t.autoTable({head:s,body:i}),t.save("export-table.pdf")}))},exportCsvTable(){Promise.resolve().then(s.t.bind(null,"1146",7)).then((e=>{let t,s,i;if(i=this.data,this.newColumns.length>0){const e=[];i.forEach(((t,s,i)=>{let a={};this.newColumns.forEach(((e,s,i)=>{a[e.name]=t[e.field]})),console.log("données exportables:",a),e.push(a)})),t=this.newColumns,s=e}else{let e=[];this.newColumns.forEach((t=>{let s={title:t.name,dataKey:t.field};"Actions"!=t.name&&e.push(s)})),console.log("Columns :",e),t=e;const a=[];i.forEach(((e,t,s)=>{let i={};this.newColumns.forEach(((t,s,a)=>{i[t.name]=e[t.field]})),console.log("données exportables:",i),a.push(i)})),s=a}s.map((e=>(delete e._id,e)));let a=[t.filter((e=>"_id"!=e.name)).map((e=>e.name))];const l=p["utils"].book_new();e.utils.sheet_add_aoa(l,a);const o=e.utils.sheet_add_json(l,s,{origin:"A2",skipHeader:!0}),n=e.utils.sheet_to_csv(o,{FS:","}),r=Object(g["a"])("table-export.csv",n,"text/csv");!0!==r&&this.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}))},rowSelect(e,t,s){this.$emit("row-click",e,t,s)},...Object(o["c"])("tables",{getDatas:"getTableQuery"}),whereDateYearEq(e){return t=>t.split("/")[2]===e},whereDateMonthrEq(e){return t=>t.split("/")[2]===e},whereDateDayEq(e){return t=>t.split("/")[2]===e},whereContain(e){return t=>-1!=String(t).indexOf(e)},whereDateBetween(e,t){return s=>d["b"].isBetweenDates(new Date(s.split("/")[2],s.split("/")[1],s.split("/")[0]),new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]),new Date(t.split("/")[2],t.split("/")[1],t.split("/")[0]),{onlyDate:!0,inclusiveFrom:!0,inclusiveTo:!0})},whereDateDuJour(e){let t=new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]);return e=>d["b"].isSameDate(new Date(e.split("/")[2],e.split("/")[1],e.split("/")[0]),t)},whereTypeAcces(e){return t=>String(t).trim()==e},filterRangeDate(e){console.log("test datesel",e),e&&Object(e).hasOwnProperty("from")&&Object(e).hasOwnProperty("to")&&(console.log("test datesel 1 :",e),e.from&&e.to&&(this.filters["datevisite"]=this.whereDateBetween(e.from,e.to),console.log("filtre :",this.filters["datevisite"]),this.customFilter=this.filterArray(this.data,this.filters)))},filterDateVisite(e){e&&(this.filters["datevisite"]=this.whereDateDuJour(e),this.customFilter=this.filterArray(this.data,this.filters))},filterTypeAcces(e){e&&(this.currentAcces=e,this.filters["typeacces"]=this.whereTypeAcces(e),this.customFilter=this.filterArray(this.data,this.filters))},updateFilters(e,t){console.log("Object SCOPE :",e),Object(e.value).hasOwnProperty("option")&&(e.value.option&&"annee"===e.value.option&&(this.filters[`${t}`]=""!=e.value.value?this.whereDateYearEq(e.value.value):""),e.value.option&&"mois"===e.value.option&&(this.filters[`${t}`]=""!=e.value.value?this.whereDateMonthEq(e.value.value):""),e.value.option&&"jour"===e.value.option&&(this.filters[`${t}`]=""!=e.value.value?this.whereDateDayEq(e.value.value):"")),console.log("Filters :",this.filters),console.log("Filters Params:",this.filtersParams),console.log("Colonne filtre update :",t),this.customFilter=this.filterArray(this.data,this.filters),e.set()},deleteFilters(e,t){this.filters[`${t}`]="",this.customFilter=this.filterArray(this.data,this.filters),this.filtersParams[`${t}`].value="",e.set()},async addRow(){if(0==this.newColumns.length)return;console.log("Edit rows :",this.editRow);const e=await this.$store.dispatch("tables/create",[this.editRow,{query:{tableDb:this.dbtype,tableName:this.dbname}}]);console.log("Added row :",e),await this.updateDatas()},async updateRow(){if(console.log("Edit rows :",this.selectedRow),delete this.$refs["editForm"].fieldData._id,console.log("Form datas :",this.$refs["editForm"].fieldData),this.selectedRow){const e=await f["c"].service("tables").update(this.selectedRow._id,this.$refs["editForm"].fieldData,{query:{tableDb:this.dbtype,tableName:this.dbname}});console.log("Données modifiées :",e),await this.updateDatas()}},async updateDatas(){let e,t,s=await f["c"].service("tables").find({query:{tableDb:this.dbtype,tableName:this.dbname,query:JSON.stringify({query:{}})}});if(console.log("Table result :",s),this.data=Object.assign([],s),this.data.length>0){let a=s.map((e=>`${Object.keys(e).length}`));console.log("Count keys :",a);let l=Math.max(...a);console.log("Nb max props :",l);let o=a.findIndex((e=>Number(e)==Number(l)));var i=Object.keys(this.data[o]);if(console.log("Columns :",i),e=await f["c"].service("tables").find({query:{tableDb:this.dbtype,tableName:"formulaires",query:JSON.stringify({query:{nom:`${this.dbname.split("dbf_")[1]}`}})}}),console.log(`INFOS Formulaire associé ${this.dbname.split("dbf_")[1]}:`,e),e&&1==e.length&&Array.isArray(e[0].data)&&(t=e[0].data,i=t.map((e=>`${e.id}`)),this.lieuAcces=t.filter((e=>"typeacces"==e.id))[0].field_options.options.map((e=>`${e.label}`))),this.editRow=i.reduce(((e,t)=>(e[t]="",e)),{}),this.newColumns=i.map((e=>({name:e,align:"center",label:e,field:e,sortable:!0}))),this.labelsColumns&&this.labelsColumns.length>0)console.log("Label :",this.labelsColumns),console.log("Columns :",this.newColumns),this.labelsColumns.forEach(((e,t)=>{if(e.id&&e.label){let t=this.newColumns.findIndex((t=>t.name==e.id));console.log("Index :",t),-1!=t&&(this.newColumns[t].label=e.label)}}));else if(e&&1==e.length&&t)this.datesFields=[],t.forEach(((e,t)=>{if(-1!=this.newColumns.findIndex((t=>t.name==e.id))){let t=this.newColumns.findIndex((t=>t.name==e.id));this.newColumns[t].label=String(e.label).trim().replace(":",""),"date"==e.field_type&&this.datesFields.push(e.id)}})),console.log("Champs types date :",this.datesFields),console.log(" Form Columns :",this.newColumns);else{const e=Object.assign([],this.newColumns.map((e=>({id:e.name,label:e.name}))));e.forEach(((e,t)=>{if(e.id&&e.label){let t=this.newColumns.findIndex((t=>t.name==e.id));this.newColumns[t].label=e.label}})),console.log("Columns :",this.newColumns)}}if(this.visibleColumns=Object.assign([],this.newColumns),console.log("Visible columns :",this.visibleColumns),!this.hideid||this.editable&&this.selectable){let e=Object.assign([],this.visibleColumns.map((e=>`${e.field.trim()}`)));this.visibleColumns=Object.assign([],e),console.log("Visible columns :",this.visibleColumns)}else{let e=Object.assign([],this.visibleColumns.filter((e=>"_id"!=e.field)).map((e=>`${e.field.trim()}`)));this.visibleColumns=Object.assign([],e),console.log("Visible columns :",this.visibleColumns)}this.filters=this.visibleColumns.reduce(((e,t)=>(e[t]="",e)),{}),this.filtersParams=this.visibleColumns.reduce(((e,t)=>(e[t]={},e)),{}),console.log("Filters :",this.filters),console.log("Filters Params:",this.filtersParams),this.customFilter=this.filterArray(this.data,this.filters),console.log("Custom filter :",this.customFilter)},async deletedRow(){if(1==this.selected.length){const e=await this.$store.dispatch("tables/remove",[this.selected[0]._id,{query:{tableDb:this.dbtype,tableName:this.dbname}}]);console.log("Deleted row :",e),await this.updateDatas()}},supPrevBtn(){this.$q.dialog({title:"Confirmation",message:"Vous allez supprimer définitivement cette ligne ?",ok:{push:!0,label:"Oui",color:"negative"},cancel:{push:!0,label:"Non"},persistent:!0}).onOk((async()=>{await this.deletedRow()})).onCancel((()=>{})).onDismiss((()=>{}))}},async beforeMount(){console.log("Store context",this.$store);const{Table:e}=this.$FeathersVuex.api;this.dbtype&&this.dbname?(e.find({query:{tableDb:this.dbtype,tableName:this.dbname,query:JSON.stringify({})}}).then((e=>{console.log("Table :",e)})),console.log("DbName :",this.dbname),await this.updateDatas()):this.data=Object.assign([],this.datas)},async mounted(){if(console.log("Table :",this.data),this.$root.$on("changeDate",(e=>{console.log("Selection de la date :",e)})),Array.isArray(this.columns)&&this.columns.length>0)this.editRow=this.columns.reduce(((e,t)=>(e[t]="",e)),{}),console.log("Edit rows :",this.editRow),this.newColumns=this.columns.map((e=>({name:e,align:"center",label:e,field:e,sortable:!0})));else{if(this.data.length>0){const e=Object.keys(this.data[0]);console.log("Columns :",e),this.editRow=e.reduce(((e,t)=>(e[t]="",e)),{}),this.newColumns=e.map((e=>({name:e,align:"center",label:e,field:e,sortable:!0})))}this.visibleColumns=Object.assign([],this.newColumns),this.hideid&&(this.visibleColumns=Object.assign([],this.visibleColumns.filter((e=>"_id"!=e.field)).map((e=>`${e.field.trim()}`))),console.log("Visible columns :",this.visibleColumns))}},watch:{scope:{handler(e){console.log("SCOPE EVENT :",e)}},selected(){console.log("Selection :",this.selected),this.selected.length>0&&(Object.assign(this.selectedRow,this.selected[0]),this.$emit("row-click","case à cocher",this.selectedRow))},data(){console.log("Table data:",this.data)},selectedRow(){console.log("Changement de données")}},errorCaptured(e,t,s){console.log("Error :",error),console.log("Vm component :",t),console.log("Info :",s)}}),T=E,M=s("ee89"),$=s("eaac"),P=s("bd08"),Q=s("357e"),N=s("4e73"),R=s("42a1"),V=s("ddd8"),J=s("27f9"),I=s("db86"),U=s("0016"),B=s("24e8"),L=s("f09f"),Y=s("a370"),z=s("4b7e"),H=s("7cbe"),K=s("52ee"),W=s("f20b"),G=s("1c1c"),X=s("66e5"),Z=s("4074"),ee=s("0170"),te=s("65c6"),se=s("6ac5"),ie=s("7f67"),ae=Object(D["a"])(T,m,h,!1,null,null,null),le=ae.exports;S()(ae,"components",{QUploader:M["a"],QBtn:y["a"],QTable:$["a"],QTr:P["a"],QTh:Q["a"],QMenu:N["a"],QPopupEdit:R["a"],QSelect:V["a"],QInput:J["a"],QTd:I["a"],QTooltip:_["a"],QIcon:U["a"],QDialog:B["a"],QCard:L["a"],QCardSection:Y["a"],QCardActions:z["a"],QPopupProxy:H["a"],QDate:K["a"],QBtnDropdown:W["a"],QList:G["a"],QItem:X["a"],QItemSection:Z["a"],QItemLabel:ee["a"],QToolbar:te["a"],QToolbarTitle:se["a"]}),S()(ae,"directives",{ClosePopup:ie["a"]});var oe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row q-col-gutter-sm"},[i("f-vv-form",{attrs:{title:"accueil",hiddenFields:[]}}),i("q-dialog",{model:{value:e.showUserInfos,callback:function(t){e.showUserInfos=t},expression:"showUserInfos"}},[i("q-card",[i("q-toolbar",{staticClass:"text-primary"},[i("div",{staticClass:"q-pt-xs"},[i("img",{attrs:{src:s("056e")}})]),i("q-toolbar-title",[e._v(" Sélection de l'heure de sortie  ")]),i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(t){e.showUserInfos=!1}}})],1),i("q-card-section",[i("div",{staticClass:"text-h6 text-center"},[e._v("Heure de Sortie du visiteur "+e._s(Object(e.selectedUser).hasOwnProperty("prenom")&&Object(e.selectedUser).hasOwnProperty("nom")?e.selectedUser["prenom"]+" "+e.selectedUser["nom"]:""))])]),i("q-card-section",{staticClass:"text-center"},[i("q-time",{attrs:{format24h:"","now-btn":""},model:{value:e.selectedUser.heuresortie,callback:function(t){e.$set(e.selectedUser,"heuresortie",t)},expression:"selectedUser.heuresortie"}})],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Memoriser",color:"primary"},on:{click:function(t){return e.saveOutTime(e.selectedUser.heuresortie)}}})],1)],1)],1)],1)},ne=[],re=s("148b"),ce=Object(l["d"])({components:{FAcceuilTable:le,FVvForm:F},name:"FAccueil",data(){return{tvue:"formulaire",splitterModel:15,showUserInfos:!1,selectedUser:{}}},props:{title:{type:String,required:!1}},computed:{...Object(o["e"])("adinfos",{isAdmin:e=>e.isAdmin,isSiteAdmin:e=>e.isSiteAdmin})},methods:{initHFields(){console.log("Form init :",this)},onRowClick(e,t){console.log("Ligne sélectionnée : ",e,t),t&&(this.selectedUser=t,"case à cocher"!=e&&(this.showUserInfos=!0),console.log("Table ref :",this.$refs.myTable))},async saveOutTime(e){this.$q.loading.show({spinner:re["a"],spinnerColor:"primary",message:"Enregistrement de l'heure de sortie.."});const t=await f["c"].service("tables").update(this.selectedUser._id,this.selectedUser,{query:{tableDb:"db_regvisiteurs",tableName:"dbf_"+this.title}});console.log("Données modifiées :",t),await this.$refs.myTable.updateDatas(),this.$q.loading.hide()}},watch:{tvue:{handler(e){console.log("Changement de MENU :",e)}}}}),de=ce,ue=(s("31c3"),s("ca78")),me=s("7460"),he=Object(D["a"])(de,oe,ne,!1,null,null,null),pe=he.exports;S()(he,"components",{QDialog:B["a"],QCard:L["a"],QToolbar:te["a"],QToolbarTitle:se["a"],QBtn:y["a"],QCardSection:Y["a"],QTime:ue["a"],QCardActions:z["a"],QTab:me["a"]}),S()(he,"directives",{ClosePopup:ie["a"]});var be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-splitter",{staticClass:"compParking",staticStyle:{height:"100%"},scopedSlots:e._u([{key:"before",fn:function(){return[s("q-tabs",{staticClass:"text-teal",attrs:{vertical:""},model:{value:e.tvue,callback:function(t){e.tvue=t},expression:"tvue"}},[s("q-tab",{attrs:{name:"formulaire",icon:"feed",label:"Formulaire"}}),s("q-tab",{attrs:{name:"donnees",icon:"list_alt",label:"Liste"}})],1)]},proxy:!0},{key:"after",fn:function(){return[s("q-tab-panels",{attrs:{animated:"",vertical:"","transition-prev":"jump-up","transition-next":"jump-up"},model:{value:e.tvue,callback:function(t){e.tvue=t},expression:"tvue"}},[s("q-tab-panel",{staticClass:"q-pt-none",attrs:{name:"formulaire"}},[s("div",{staticClass:"text-h5 text-center q-mb-md"},[e._v("\n          Formulaire pour un nouveau visiteur\n        ")]),s("f-vv-form",{attrs:{title:"parking"}})],1),s("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"donnees"}})],1)]},proxy:!0}]),model:{value:e.splitterModel,callback:function(t){e.splitterModel=t},expression:"splitterModel"}})},fe=[],ge=Object(l["d"])({name:"FParking",components:{FVvForm:F},data(){return{tvue:"formulaire",splitterModel:20}},props:{title:{type:String,required:!1}},methods:{onRowClick(e){}}}),ve=ge,we=(s("d864"),s("8562")),ye=s("429b"),_e=s("adad"),qe=s("823b"),Ce=Object(D["a"])(ve,be,fe,!1,null,null,null),xe=Ce.exports;S()(Ce,"components",{QSplitter:we["a"],QTabs:ye["a"],QTab:me["a"],QTabPanels:_e["a"],QTabPanel:qe["a"]});var De=s("f9ea");const{lighten:ke,setBrand:Ae}=n["a"];var Oe=Object(l["d"])({components:{FAcceuilTable:le,FVvForm:F,FAccueil:pe,FParking:xe},name:"PageAcceuil",data(){const e={days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Aôut_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jun_Jui_Aou_Sep_Oct_Nov_Déc".split("_"),firstDayOfWeek:0};return{senderTo:"",subjectTo:"",messageTo:"",tabForm:"accueil",showAdminMenu:!1,showUserMenu:!1,showMailMessage:!1,datedujour:d["b"].formatDate(Date.now(),"DD/MM/YYYY"),myLocale:e}},computed:{...Object(o["e"])("adinfos",{isAdmin:e=>e.isAdmin,isSiteAdmin:e=>e.isSiteAdmin}),...Object(o["e"])("admin",{formData:e=>e.getform,fconfig:e=>e.config,visiteurs:e=>e.visiteurs}),...Object(o["e"])("auth",{currentUsername:e=>e.user.displayName}),displayName(){return this.currentUsername},othersMenu(){return this.plusMenu},totalVisiteurs(){if(this.visiteurs&&Array.isArray(this.visiteurs))return this.visiteurs.filter((e=>e.datevisite==this.datedujour)).length},totalRdcVisiteurs(){if(this.visiteurs&&Array.isArray(this.visiteurs))return this.visiteurs.filter((e=>e.datevisite==this.datedujour&&"RDC"==e.typeacces)).length},totalParkingVisiteurs(){if(this.visiteurs&&Array.isArray(this.visiteurs))return this.visiteurs.filter((e=>e.datevisite==this.datedujour&&"PARKING"==e.typeacces)).length}},methods:{...Object(o["c"])("admin",["getAllVisiteurs","getAllUsers","addVisiteur","getForm","saveForm","getConfig","writeConfig","sendMail"]),async saveSendMail(){const e=Object.assign({},this.fconfig);e["mail"]=Object.assign({},{to:this.senderTo,subject:this.subjectTo,message:this.messageTo}),console.log("New config :",e),this.$q.loading.show({spinner:c["a"],spinnerColor:"blue",message:"Chargement en cours..."}),await this.writeConfig(e),this.$q.loading.hide(),this.$q.dialog({message:"Paramettre de la messagerie sauvegardée!"})},saveDate(){console.log("Nouvelle date :",this.datedujour)},async testSendMail(){console.log("Message à envoyé :",this.messageTo),this.sendMail({to:this.senderTo,subject:this.subjectTo,message:this.messageTo}).then((()=>{this.$q.dialog({message:"Message envoyé!"})})).catch((()=>{this.$q.dialog({message:"!! Message non envoyé!"})}))},openExtURL(e){Object(u["a"])(e,null)},showSettings(e){this.$q.dialog({component:De["a"],config:this.fconfig,twidth:"70%"}).onOk((async e=>{console.log("OK settings",e),await this.writeConfig(e),Object(e).hasOwnProperty("bgright")&&n["a"].setBrand("bgright",e.bgright)})).onCancel((()=>{console.log("Cancel")})).onDismiss((()=>{console.log("Called on OK or Cancel")}))},changeDate(e,t,s){console.log("click date :",e),null==e&&(this.datedujour=d["b"].formatDate(Date.now(),"DD/MM/YYYY")),this.$root.$emit("changeDate",this.datedujour),this.$refs.ladatedujour.hide()},onRowClick(e,t){console.log("Ligne sélectionnée : ",e,t),t&&(this.selectedUser=t,"case à cocher"!=e&&(this.showUserInfos=!0),console.log("Table ref :",this.$refs.myTable))}},async beforeMount(){this.plusMenu=await this.$store.dispatch("tables/find",{query:{tableDb:"db_regvisiteurs",tableName:"plusMenu",query:JSON.stringify({query:{}})}}),console.log("Menus ajoutes :",this.plusMenu),await this.getConfig(),Object(this.fconfig).hasOwnProperty("bgright")&&n["a"].setBrand("bgright",this.fconfig.bgright),console.log("Meta infos :",this.$route.query.type),this.$q.loading.show({spinner:r["a"],spinnerColor:"red",message:"Chargement en cours..."}),await this.getAllVisiteurs(),this.$q.loading.hide()},async mounted(){particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:5},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:3,random:!0,anim:{enable:!1,speed:20,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:6,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!1,mode:"grab"},onclick:{enable:!1,mode:"push"},resize:!0},modes:{grab:{distance:140,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!1}),await this.getAllUsers(),console.log("Les visiteurs :",this.visiteurs)}}),Se=Oe,je=(s("de25"),s("9989")),Fe=s("eb85"),Ee=s("cb32"),Te=s("3845"),Me=s("3b73"),$e=s("58a81"),Pe=s("d66b"),Qe=s("6b1d"),Ne=Object(D["a"])(Se,i,a,!1,null,null,null);t["default"]=Ne.exports;S()(Ne,"components",{QPage:je["a"],QIcon:U["a"],QSeparator:Fe["a"],QCard:L["a"],QCardSection:Y["a"],QAvatar:Ee["a"],QKnob:Te["a"],QTooltip:_["a"],QExpansionItem:Me["a"],QBadge:$e["a"],QToolbar:te["a"],QBtn:y["a"],QToolbarTitle:se["a"],QPopupProxy:H["a"],QDate:K["a"],QDialog:B["a"],QInput:J["a"],QEditor:Pe["a"],QLinearProgress:Qe["a"],QList:G["a"],QItemLabel:ee["a"],QItem:X["a"],QItemSection:Z["a"],QTab:me["a"]}),S()(Ne,"directives",{ClosePopup:ie["a"]})},"7b35":function(e,t,s){},d864:function(e,t,s){"use strict";s("0697")},de25:function(e,t,s){"use strict";s("7b35")}}]);